{"Name":"Article Management - Sandbox","ConfigurationID":"78e42c24-80dd-4c99-a978-d39ba76587d6","searchItems":[],"queryItems":[],"listItems":[],"messageItems":[{"Index":1,"Level":0,"Parameters":{"Name":"OnLoad","RenderType":"0","skipDebug":"False","includeSearch":"False","includeExport":"False","includeImport":"False"},"ActionType":"Action-Region","ChildActions":[{"Index":2,"Level":0,"Parameters":{"Value":"HISTORY\n=======\n\n"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":3,"Level":0,"Parameters":{"Type":"CONTROL.HEADER","Name":"","Value":"<script src=\"/js/tooltipmain.js\" type=\"text/javascript\"></script>\n<style type=\"text/css\">\nimg {border:0}\nth {font-size:20px,font-weight:bold;text-align:left;color:#000;background-color:#e7e7e7}\n.formlabel{text-align:right;vertical-align:top;font-weight:bold}\n.fin {color:#065c06;font-weight:bold}\n.unfin {color:#ff0000;font-weight:bold}\n/* root element for tabs  */\nul.Ufiler-tabs {  \n\tmargin:0 !important; \n\tpadding:0;\n\theight:30px;\n\tborder-bottom:1px solid #666;\t \t\n}\n\n/* single tab */\nul.Ufiler-tabs li {  \n\tfloat:left;\t \n\tpadding:0; \n\tmargin:0;  \n\tlist-style-type:none;\t\n}\n\n/* link inside the tab. uses a background image */\nul.Ufiler-tabs a { \n\tfloat:left;\n\tfont-size:13px;\n\tdisplay:block;\n\tpadding:5px 15px;\t\n\ttext-decoration:none;\n\tborder:1px solid #666;\t\n\tborder-bottom:0px;\n\theight:18px;\n\tbackground-color:#efefef;\n\tcolor:#777;\n\tmargin-right:3px;\n\tposition:relative;\n\ttop:1px;\t\n\toutline:0;\n\tborder-radius:6px 6px 0 0;\t\n}\n\nul.Ufiler-tabs a:hover {\n\tbackground-color:#F7F7F7;\n\tcolor:#333;\n}\n\t\n/* selected tab */\nul.Ufiler-tabs a.current {\n\tbackground-color:#ddd;\n\tborder-bottom:1px solid #ddd;\t\n\tcolor:#000;\t\n\tcursor:default;\n\ttext-align:left;\n}\n\n\n/* tab pane */\n.Ufiler-panes {\n/*\tdisplay:none; */\n\tborder:1px solid #666;\n\tborder-width:0 1px 1px 1px;\n/*\theight:800px; */\n\toverflow:auto;\n\tpadding:10px 5px 10px 5px;\n/*\tmargin-right:10px;*/\n\tbackground-color:#ddd;\n\tclear:both;\t\n\n}\n.Ufiler-Content {\n\ttext-align:left;\n}\n.PagerDiv {margin:0px auto 0px auto;}\n.PagingLink {padding:5px;margin-left:2px;margin-right:2px;border:1px solid #ccc; background:#fff;}\n.ActiveLink {background:yellow; color:red;}\n#tooltip{\n\tposition:absolute;\n\tborder:1px solid #333;\n\tbackground:#f7f5d1;\n\tpadding:2px 5px;\n\tcolor:#333;\n\tdisplay:none;\n\t}\ntd.iconcol {width:18px;text-align:center}\n</style>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":4,"Level":0,"Parameters":{"Name":"Table Definitions & Scripts","RenderType":"0","skipDebug":"false","includeSearch":"false","includeExport":"false","includeImport":"false"},"ActionType":"Action-Region","ChildActions":[{"Index":5,"Level":0,"Parameters":{"Value":"Module Settings Module - import to OWS and use in Module Settings"},"ActionType":"Action-Comment","ChildActions":[{"Index":6,"Level":0,"Parameters":{"Name":"Ufiler 2AM Article Asset Management Module Settings","Query":"{\"Name\":\"Ufiler 2AM Article Asset Management Module Settings\",\"ConfigurationID\":\"13233427-6752-7c91-228b-1e27dcea127e\",\"searchItems\":[],\"queryItems\":[],\"listItems\":[],\"messageItems\":[{\"Index\":1,\"Level\":0,\"Parameters\":{\"Type\":\"Detail-NoQuery\",\"GroupStatement\":\"\",\"GroupIndex\":\"\",\"Value\":\"<span class=\\\"head\\\">Ufiler 2AM Module Settings</span>\\n<hr />\\n<table width=\\\"100%\\\" cellspacing=\\\"3\\\" cellpadding=\\\"3\\\">\\n\\t<tr valign=\\\"top\\\"> \\n\\t\\t<td class=\\\"subhead\\\">Manager Role (members of this role can change DropDown lists and manage Assets)</td>\\n\\t\\t<td class=\\\"normal\\\">{SUBQUERY, Name=\\\"getManagerRole\\\", Query=\\\"select RoleID, RoleName from roles where PortalID = [PortalID,system] order by RoleName\\\" , Header=\\\"<select id='frmManagerRoleID' name='frmManagerRoleID' size='1'>\\\", Footer=\\\"</select>\\\", Format=\\\"<option value='\\\\[RoleID]'>\\\\[RoleName]</option>\\\", SelectedFormat=\\\"<option value='\\\\[RoleID]' selected='selected'>\\\\[RoleName]</option>\\\", SelectedField=\\\"RoleID\\\", SelectedItems=\\\"[ManagerRoleID,ModuleSettings]\\\", UseCache=False}</td>\\n\\t</tr>\\n\\t<tr> \\n\\t\\t<td class=\\\"subhead\\\">Select Ventrian FileLinks module as dropbox</td>\\n\\t\\t<td class=\\\"normal\\\"><input type=\\\"select\\\" name=\\\"frmDropbox\\\" /></td>\\n\\t</tr>\\n\\t<tr> \\n\\t\\t<td class=\\\"subhead\\\">Email Nofifications:</td>\\n\\t\\t<td class=\\\"normal\\\"><input type=\\\"radio\\\" name=\\\"rEmail\\\" value=\\\"1\\\" id=\\\"rEmailOn\\\" {IIF, \\\"'[MailEnabled,ModuleSettings]'='1'\\\", \\\"checked='checked'\\\", \\\"\\\"}/> <label for=\\\"rEmailOn\\\">On</label><br />\\n\\t\\t\\t<input type=\\\"radio\\\" name=\\\"rEmail\\\" value=\\\"0\\\" id=\\\"rEmailOff\\\" {IIF, \\\"'[MailEnabled,ModuleSettings]'<>'1'\\\", \\\"checked='checked'\\\", \\\"\\\"}/> <label for=\\\"rEmailOff\\\">Off</label></td>\\n\\t</tr>\\n\\t<tr> \\n\\t\\t<td class=\\\"subhead\\\">Allow Editor Lock:</td>\\n\\t\\t<td class=\\\"normal\\\"><input type=\\\"checkbox\\\" name=\\\"chkAllowEditorLock\\\" value=\\\"1\\\" id=\\\"EditorLockAllowedTrue\\\" {IIF, \\\"'[AllowEditorLock,ModuleSettings]'='1'\\\", \\\"checked='checked'\\\", \\\"\\\"}/></td>\\n\\t</tr>\\n\\t<tr> \\n\\t\\t<td class=\\\"subhead\\\">Use External Contacts:</td>\\n\\t\\t<td class=\\\"normal\\\"><input type=\\\"checkbox\\\" name=\\\"chkUseExternalContacts\\\" value=\\\"1\\\" id=\\\"UseExternalContactsTrue\\\" {IIF, \\\"'[UseExternalContacts,ModuleSettings]'='1'\\\", \\\"checked='checked'\\\", \\\"\\\"}/></td>\\n\\t</tr>\\n\\t<tr> \\n\\t\\t<td class=\\\"subhead\\\">Logging:</td>\\n\\t\\t<td class=\\\"normal\\\"><input type=\\\"radio\\\" name=\\\"rLogging\\\" value=\\\"1\\\" id=\\\"rLoggingOn\\\" {IIF, \\\"'[Logging,ModuleSettings]'='1'\\\", \\\"checked='checked'\\\", \\\"\\\"}/> <label for=\\\"rLoggingOn\\\">On</label><br />\\n\\t\\t\\t<input type=\\\"radio\\\" name=\\\"rLogging\\\" value=\\\"0\\\" id=\\\"rLoggingOff\\\" {IIF, \\\"'[Logging,ModuleSettings]'<>'1'\\\", \\\"checked='checked'\\\", \\\"\\\"}/> <label for=\\\"rLoggingOff\\\">Off</label></td>\\n\\t</tr>\\n\\t<tr> \\n\\t\\t<td class=\\\"subhead\\\">OWS.Visible?:</td>\\n\\t\\t<td class=\\\"normal\\\"><input type=\\\"radio\\\" name=\\\"OpenWebStudio.Visible\\\" value=\\\"True\\\" id=\\\"OpenWebStudio.VisibleOn\\\" {IIF, \\\"'[OpenWebStudio.Visible,ModuleSettings]'='True'\\\", \\\"checked='checked'\\\", \\\"\\\"}/> <label for=\\\"OpenWebStudio.VisibleOn\\\">True</label><br />\\n\\t\\t\\t<input type=\\\"radio\\\" name=\\\"OpenWebStudio.Visible\\\" value=\\\"False\\\" id=\\\"OpenWebStudio.VisibleOff\\\" {IIF, \\\"'[OpenWebStudio.Visible,ModuleSettings]'='False'\\\", \\\"checked='checked'\\\", \\\"\\\"}/> <label for=\\\"OpenWebStudio.VisibleOff\\\">False</label></td>\\n\\t</tr>\\n\\n\\n</table>\",\"Connection\":\"\",\"Filter\":\"\",\"CacheTime\":\"\",\"CacheName\":\"\",\"CacheShared\":\"false\"},\"ActionType\":\"Template\",\"ChildActions\":[]},{\"Index\":2,\"Level\":0,\"Parameters\":{\"Type\":\"Settings\",\"Value\":\"Update\"},\"ActionType\":\"Message\",\"ChildActions\":[{\"Index\":3,\"Level\":0,\"Parameters\":{\"Type\":\"&lt;Module Setting&gt;\",\"Name\":\"UseExternalContacts\",\"Value\":\"[chkUseExternalContacts,form:number]\",\"SkipProcessing\":\"false\",\"AssignmentType\":\"0\"},\"ActionType\":\"Action-Assignment\",\"ChildActions\":[]},{\"Index\":4,\"Level\":0,\"Parameters\":{\"Type\":\"&lt;Module Setting&gt;\",\"Name\":\"AllowEditorLock\",\"Value\":\"[chkAllowEditorLock,form:number]\",\"SkipProcessing\":\"false\",\"AssignmentType\":\"0\"},\"ActionType\":\"Action-Assignment\",\"ChildActions\":[]},{\"Index\":5,\"Level\":0,\"Parameters\":{\"Type\":\"&lt;Module Setting&gt;\",\"Name\":\"ManagerRoleID\",\"Value\":\"[frmManagerRoleID,form:number]\",\"SkipProcessing\":\"false\",\"AssignmentType\":\"0\"},\"ActionType\":\"Action-Assignment\",\"ChildActions\":[]},{\"Index\":6,\"Level\":0,\"Parameters\":{\"Type\":\"&lt;Module Setting&gt;\",\"Name\":\"MailEnabled\",\"Value\":\"[rEmail,form:number]\",\"SkipProcessing\":\"false\",\"AssignmentType\":\"0\"},\"ActionType\":\"Action-Assignment\",\"ChildActions\":[]},{\"Index\":7,\"Level\":0,\"Parameters\":{\"Type\":\"&lt;Module Setting&gt;\",\"Name\":\"Logging\",\"Value\":\"[rLogging,form:number]\",\"SkipProcessing\":\"false\",\"AssignmentType\":\"0\"},\"ActionType\":\"Action-Assignment\",\"ChildActions\":[]},{\"Index\":8,\"Level\":0,\"Parameters\":{\"Type\":\"&lt;Module Setting&gt;\",\"Name\":\"OpenWebStudio.Visible\",\"Value\":\"[OpenWebStudio.Visible,form]\",\"SkipProcessing\":\"false\",\"AssignmentType\":\"0\"},\"ActionType\":\"Action-Assignment\",\"ChildActions\":[]}]}],\"recordsPerPage\":\"0\",\"enableAlphaFilter\":\"false\",\"enablePageSelection\":\"false\",\"enableRecordsPerPage\":\"false\",\"enableCustomPaging\":\"false\",\"enableExcelExport\":false,\"enableHide_OnNoQuery\":false,\"enableHide_OnNoResults\":false,\"enableAdvancedParsing\":true,\"enableCompoundIIFConditions\":\"true\",\"enableQueryDebug\":\"true\",\"enableQueryDebug_Edit\":\"false\",\"enableQueryDebug_Admin\":\"false\",\"enableQueryDebug_Super\":\"false\",\"enableQueryDebug_Log\":false,\"enableQueryDebug_ErrorLog\":false,\"autoRefreshInterval\":\"\",\"skipRedirectActions\":\"false\",\"skipSubqueryDebugging\":\"false\",\"enableAdmin_Edit\":true,\"enableAdmin_Admin\":false,\"enableAdmin_Super\":false,\"BotRecordCount\":0,\"BotPageVariableName\":null,\"enableBotShowAllRecords\":false,\"enableBotDetection\":false,\"BotNonAjaxText\":null,\"disableOpenScript\":false,\"enableSilverlight\":false,\"enableAJAX\":\"false\",\"enableAJAXPaging\":\"false\",\"enableAJAXCustomPaging\":\"false\",\"enableAJAXCustomStatus\":\"false\",\"enableAJAXPageHistory\":\"false\",\"customAJAXPageHistory\":\"\",\"enableAJAXManual\":\"false\",\"includeJavascriptUtilities\":\"false\",\"includeJavascriptValidation\":\"false\",\"javascriptInclude\":[],\"javascriptOnComplete\":\"\",\"enableMultipleColumnSorting\":\"false\",\"ModuleCommunicationMessageType\":\"\",\"showAll\":\"true\",\"useExplicitSystemVariables\":\"false\",\"enabledForcedQuerySplit\":\"false\",\"query\":\"\",\"filter\":\"\",\"customConnection\":\"\",\"listItem\":\"\",\"listAItem\":\"\",\"defaultItem\":\"\",\"noqueryItem\":\"\",\"SearchQuery\":\"\",\"SearchTitle\":\"\",\"SearchLink\":\"\",\"SearchAuthor\":\"\",\"SearchDate\":\"\",\"SearchKey\":\"\",\"SearchContent\":\"\",\"SearchDescription\":\"\",\"Header\":null,\"Footer\":null,\"Title\":null,\"Version\":\"20\"}","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":7,"Level":0,"Parameters":{"Value":"SQL Installation script"},"ActionType":"Action-Comment","ChildActions":[{"Index":8,"Level":0,"Parameters":{"Name":"SQL_Data_Provider_00.00.01","Query":"-- Scripts to create the Ufiler_2AM tables, functions and views\n\nSET ANSI_NULLS ON\ngo\n\nSET QUOTED_IDENTIFIER ON\ngo\n\nSET ANSI_PADDING ON\nGO\n\n--** \n--** Number Table\n--** \n\n--===== If the table already exists, something may be wrong and we need \n-- to alert the operator before continuing.\nIF OBJECT_ID('dbo.Ufiler_Number','U') IS NOT NULL \n\tBEGIN\n\t\tRAISERROR('RUN ABORTED. Ufiler_Number already exists.',11,1)\n\t\tRAISERROR('Please drop the table if you wish to recreate.',10,1)\n\t\tRETURN\n\tEND       \n\n--===== Create and populate the Numbers table on the fly.\n-- The IDENTITY makes \"Number\" a NOT NULL column for use as a PK.\n\nSELECT TOP 100001 IDENTITY(INT,0,1) AS Number -- 73048 is 31/12/2099 \nINTO dbo.Ufiler_Number\nFROM master.sys.all_columns ac1\nCROSS JOIN master.sys.all_columns ac2\n\n--===== Add a tightly packed clustered Primary Key to maximize \n-- performance and minimize space used.\n\nALTER TABLE dbo.Ufiler_Number\nADD CONSTRAINT PK_Ufiler_Number \nPRIMARY KEY CLUSTERED (Number) WITH FILLFACTOR = 100\n \n--===== Allow the general public to use it\nGRANT SELECT ON dbo.Ufiler_Number TO PUBLIC\nGO     \n\n\n--** \n--** Create and run SProc to create and populate the date table\n--** \n\n/****** Object:  StoredProcedure [dbo].[Ufiler_DateLookup_Populate]    Script Date: 12/05/2011 09:23:28 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_DateLookup_Populate]') AND type in (N'P', N'PC'))\nDROP PROCEDURE [dbo].[Ufiler_DateLookup_Populate]\nGO\n\n\n/****** Object:  StoredProcedure [dbo].[Ufiler_DateLookup_Populate]    Script Date: 12/05/2011 09:23:28 ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\n\n-- =============================================\n-- Author:\t\t<Author,,Name>\n-- Create date: <Create Date,,>\n-- Description:\t<Description,,>\n-- =============================================\nCREATE PROCEDURE [dbo].[Ufiler_DateLookup_Populate] \nAS\nBEGIN\n\t-- SET NOCOUNT ON added to prevent extra result sets from\n\t-- interfering with SELECT statements.\n\tSET NOCOUNT ON;\n\tIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_DateLookup]') AND type in (N'U'))\n\tDROP TABLE [dbo].Ufiler_DateLookup\t\n\tCREATE TABLE [dbo].Ufiler_DateLookup\n\t (\n\t\t DateKey INT PRIMARY KEY,\n\t\t DateFull DATETIME,\n\t\t FullYear CHAR(4),\n\t\t ShortYear CHAR(2),\n\t\t QuarterNumber TINYINT,\n\t\t WeekNumber TINYINT,\n\t\t WeekDayName VARCHAR(10),\n\t\t ShortWeekDayName char(3),\n\t\t MonthDay TINYINT,\n\t\t MonthName VARCHAR(12),\n\t\t ShortMonthName char(3),\n\t\t YearDay SMALLINT,\n\t\t DateDefinition VARCHAR(30),\n\t\t CharacterDate VARCHAR(10),\n\t\t WeekDay TINYINT,\n\t\t MonthNumber TINYINT\n\t )\n\n\n\tBEGIN\n     INSERT INTO [dbo].Ufiler_DateLookup\n     (\n         DateKey, DateFull, FullYear, ShortYear,\n         QuarterNumber, WeekNumber, WeekDayName, ShortWeekDayName,\n         MonthDay, MonthName, ShortMonthName, YearDay,\n         DateDefinition, CharacterDate, WeekDay, MonthNumber\n     )\n     SELECT\n        CONVERT(VARCHAR(8), cast(Number as datetime), 112), \n\tcast(Number as datetime), \n\tYEAR(cast(Number as datetime)),\n\tRight(YEAR(cast(Number as datetime)),2),\n        DATEPART(qq, cast(Number as datetime)), \n\tDATEPART(ww, cast(Number as datetime)), \n\tDATENAME(dw, cast(Number as datetime)), \n\tleft(DATENAME(dw, cast(Number as datetime)),3),\n        DATEPART(dd, cast(Number as datetime)), \n\tDATENAME(mm, cast(Number as datetime)),\n\tleft(DATENAME(mm, cast(Number as datetime)),3), \n\tDATEPART(dy,cast(Number as datetime)),\n\tDATENAME(mm, cast(Number as datetime)) + ' ' + rtrim(CAST(DATEPART(dd, cast(Number as datetime)) AS CHAR(2))) + ', ' + CAST(DATEPART(yy, cast(Number as datetime)) AS CHAR(4)),        CONVERT(VARCHAR(10), cast(Number as datetime), 103),\n        DATEPART(dw, cast(Number as datetime)),\n        DATEPART(mm, cast(Number as datetime))\n     from [dbo].[Ufiler_Number]\n    \n\tEND\nEND\n\nGO\n\nexec Ufiler_DateLookup_Populate\nGo\n\n\n--** \n--** Person Table\n--** \n\nCREATE TABLE [dbo].[Ufiler_2AM_Person](\n\t[PersonID] [int] IDENTITY(1,1) NOT NULL,\n\t[ModuleID] [int] NOT NULL,\n\t[Forename] [nvarchar](50) NULL,\n\t[Surname] [nvarchar](50) NULL,\n\t[Commissioner] [bit] NULL,\n\t[Author] [bit] NULL,\n\t[Reviewer] [bit] NULL,\n\t[Initials]  AS (left([Forename],(1))+left([Surname],(1)))\n) ON [PRIMARY]\ngo\n\n--** \n--** Article Status Table\n--** \n\nCREATE TABLE [dbo].[Ufiler_2AM_ArticleStatus](\n\t[StatusID] [int] IDENTITY(1,1) NOT NULL,\n\t[ModuleID] [int] NOT NULL,\n\t[Status] [varchar](50) NOT NULL,\n\t[Releasable] [bit] NULL,\n\t[SeqNo] [int] NOT NULL\n) ON [PRIMARY]\n\nGO\n\n--** \n--** Article Category Table\n--** \n\nCREATE TABLE [dbo].[Ufiler_2AM_ArticleCategory](\n\t[CategoryID] [int] IDENTITY(1,1) NOT NULL,\n\t[ModuleID] [int] NOT NULL,\n\t[Category] [varchar](50) NOT NULL,\n\t[SeqNo] [int] NOT NULL\n) ON [PRIMARY]\n\nGO\n\n--** \n--** Article Table\n--** \n\nCREATE TABLE [dbo].[Ufiler_2AM_Article](\n\t[ArticleID] [int] IDENTITY(1,1) NOT NULL,\n\t[ModuleID] [int] NOT NULL,\n\t[Subject] [nvarchar](400) NOT NULL,\n\t[CategoryID] [int] NULL,\n\t[EventID] [int] NULL,\n\t[OwnerID] [int] NULL,\n\t[StatusID] [int] NOT NULL,\n\t[WrittenByID] [int] NULL,\n\t[ScheduledFor] [int] NULL,\n\t[Released] [datetime] NULL,\n\t[Published] [int] NULL,\n\t[PublishedTitle] [nvarchar](300) NULL,\n\t[Pages] [decimal](5, 3) NULL,\n\t[Locked] [bit] NULL,\n\t[Deleted] [bit] NULL,\n\t[Notes] [varchar](max) NULL\n) ON [PRIMARY]\nGO\n\n--** \n--** Article Asset Table\n--** \n\nCREATE TABLE [dbo].[Ufiler_2AM_ArticleAssetData](\n\t[AssetID] [int] IDENTITY(1,1) NOT NULL,\n\t[ModuleID] [int] NOT NULL,\n\t[AssetName] [varchar](255) NULL,\n\t[ArticleID] [int] NULL,\n\t[IndexNo] [int] NULL,\n\t[MimeType] [varchar](255) NULL,\n\t[AssetCredit] [varchar](255) NULL,\n\t[AssetDescription] [varchar](255) NULL,\n\t[ThumbnailPath] [varchar](255) NULL,\n\t[Data] [image] NULL\n) ON [PRIMARY] TEXTIMAGE_ON [PRIMARY]\nGO\n\n\n--** \n--** Article Notification Table\n--** \n\nCREATE TABLE [dbo].[Ufiler_2AM_Notification](\n\t[ModuleID] [int] NOT NULL,\n\t[UserID] [int] NOT NULL,\n\t[EmailAddress] [nvarchar](100) NULL,\n\t[ArticleCreated] [bit] NULL,\n\t[ArticleReleased] [bit] NULL,\n\t[ArticleDeleted] [bit] NULL\n) ON [PRIMARY]\nGO\n\n--** \n--** Article Category Order Function\n--** \n\nCREATE FUNCTION [dbo].[Ufiler_2AM_NewArticleCategoryOrder] \n(\n\t@ModuleID int\n)\nRETURNS int\nAS\nBEGIN\n\tRETURN (SELECT ISNULL(MAX(SeqNo),0) + 1 FROM [dbo].Ufiler_2AM_ArticleCategory where ModuleID = @ModuleID)\nEND\nGO\n\n\n--** \n--** Article Status Order Function\n--** \n\nCREATE FUNCTION [dbo].[Ufiler_2AM_NewArticleStatusOrder] \n(\n\t@ModuleID int\n)\nRETURNS int\nAS\nBEGIN\n\tRETURN (SELECT ISNULL(MAX(SeqNo),0) + 1 FROM [dbo].Ufiler_2AM_ArticleStatus where ModuleID = @ModuleID)\nEND\nGO\n\n\n--** \n--** Datekey Category View\n--** \n\nIF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_DatekeyCategory]'))\nDROP VIEW [dbo].[Ufiler_2AM_DatekeyCategory]\nGO\n\n/****** Object:  View [dbo].[Ufiler_2AM_DatekeyCategory]    Script Date: 12/06/2011 18:58:00 ******/\nSET ANSI_NULLS ON\nGO\n\nSET QUOTED_IDENTIFIER ON\nGO\n\nCREATE VIEW [dbo].[Ufiler_2AM_DatekeyCategory]\nAS\nSELECT     d.DateKey, ac.CategoryID, d.ShortMonthName, d.FullYear\nFROM         [dbo].Ufiler_DateLookup d CROSS JOIN\n                      dbo.ufiler_2AM_ArticleCategory ac\nWHERE     (d.DateFull BETWEEN DATEADD(M, - 1, GETDATE()) AND DATEADD(M, 12, GETDATE())) AND (d.MonthDay = '1')\n\nGO\n\n--** \n--** set up the constraints\n--** \n\n\nSET ANSI_PADDING OFF\nGO\n\nALTER TABLE [dbo].[Ufiler_2AM_Article] ADD  CONSTRAINT [DF_Ufiler_2AM_Article_ScheduledFor]  DEFAULT ((0)) FOR [ScheduledFor]\nGO\n\nALTER TABLE [dbo].[Ufiler_2AM_Article] ADD  CONSTRAINT [DF_Ufiler_2AM_Article_Deleted]  DEFAULT ((0)) FOR [Deleted]\nGO\n","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":9,"Level":0,"Parameters":{"Value":"SQL Uninstall Script"},"ActionType":"Action-Comment","ChildActions":[{"Index":10,"Level":0,"Parameters":{"Name":"SQL_Data_Provider_Uninstall","Query":"-- Scripts to remove the Ufiler_2AM tables, functions and views\n\n--** \n--** Datekey Category View\n--** \n\nIF  EXISTS (SELECT * FROM sys.views WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_DatekeyCategory]'))\nDROP VIEW [dbo].[Ufiler_2AM_DatekeyCategory]\nGO\n\n--** \n--** drop SProc to create and populate the date table\n--** \n\n/****** Object:  StoredProcedure [dbo].[Ufiler_DateLookup_Populate]    Script Date: 12/05/2011 09:23:28 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_DateLookup_Populate]') AND type in (N'P', N'PC'))\nDROP PROCEDURE [dbo].[Ufiler_DateLookup_Populate]\nGO\n/****** Object:  Table [dbo].[Ufiler_DateLookup]    Script Date: 12/08/2011 20:01:11 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_DateLookup]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_DateLookup]\nGO\n\n\n/****** Object:  Table [dbo].[Ufiler_Number]    Script Date: 12/08/2011 20:01:47 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_Number]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_Number]\nGO\n\n--** \n--** Person Table\n--** \n\n/****** Object:  Table [dbo].[Ufiler_2AM_Person]    Script Date: 12/08/2011 19:13:05 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_Person]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_2AM_Person]\nGO\n\n--** \n--** Article Status Table\n--** \n\n/****** Object:  Table [dbo].[Ufiler_2AM_ArticleStatus]    Script Date: 12/08/2011 19:12:40 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_ArticleStatus]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_2AM_ArticleStatus]\nGO\n\n--** \n--** Article Category Table\n--** \n\n/****** Object:  Table [dbo].[Ufiler_2AM_ArticleCategory]    Script Date: 12/08/2011 19:12:10 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_ArticleCategory]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_2AM_ArticleCategory]\nGO\n\n\n--** \n--** Article Table\n--** \n\n\nIF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_Ufiler_2AM_Article_ScheduledFor]') AND type = 'D')\nBEGIN\nALTER TABLE [dbo].[Ufiler_2AM_Article] DROP CONSTRAINT [DF_Ufiler_2AM_Article_ScheduledFor]\nEND\n\nGO\n\nIF  EXISTS (SELECT * FROM dbo.sysobjects WHERE id = OBJECT_ID(N'[DF_Ufiler_2AM_Article_Deleted]') AND type = 'D')\nBEGIN\nALTER TABLE [dbo].[Ufiler_2AM_Article] DROP CONSTRAINT [DF_Ufiler_2AM_Article_Deleted]\nEND\n\nGO\n\n\n/****** Object:  Table [dbo].[Ufiler_2AM_Article]    Script Date: 12/08/2011 19:14:53 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_Article]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_2AM_Article]\nGO\n\n--** \n--** Notfication Table\n--**\n\n/****** Object:  Table [dbo].[Ufiler_2AM_Article]    Script Date: 12/08/2011 19:14:53 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_Notification]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_2AM_Notification]\nGO\n\n--** \n--** Article Asset Table\n--** \n\n/****** Object:  Table [dbo].[Ufiler_2AM_ArticleAssetData]    Script Date: 12/08/2011 19:10:36 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_ArticleAssetData]') AND type in (N'U'))\nDROP TABLE [dbo].[Ufiler_2AM_ArticleAssetData]\nGO\n\n--** \n--** Article Category Order Function\n--** \n\n/****** Object:  UserDefinedFunction [dbo].[Ufiler_2AM_NewArticleCategoryOrder]    Script Date: 12/08/2011 20:05:33 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_NewArticleCategoryOrder]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))\nDROP FUNCTION [dbo].[Ufiler_2AM_NewArticleCategoryOrder]\nGO\n\n--** \n--** Article Status Order Function\n--** \n\n/****** Object:  UserDefinedFunction [dbo].[Ufiler_2AM_NewArticleStatusOrder]    Script Date: 12/08/2011 20:05:48 ******/\nIF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[Ufiler_2AM_NewArticleStatusOrder]') AND type in (N'FN', N'IF', N'TF', N'FS', N'FT'))\nDROP FUNCTION [dbo].[Ufiler_2AM_NewArticleStatusOrder]\nGO\n\n\n","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]}]},{"Index":11,"Level":0,"Parameters":{"LeftCondition":"'[frmGo,Form]'","RightCondition":"'Upload Asset'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":12,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@SanitisedFileNameOnly","Value":"[COALESCE,frmFile.NameOnly,Form,{LOWER},\"{REPLACE:regex(\\[^a-z0-9\\]+),-}\",\"{REPLACE:regex((^-|-$)),}\"]","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":13,"Level":1,"Parameters":{"Value":"Place all general operations within this region as a starting point. This includes Template and Variable assignments."},"ActionType":"Action-Comment","ChildActions":[{"Index":14,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@SanitisedFileNameOnly","Value":"[Format,@SanitisedFileNameOnly,action,{replace:char(93),(}]","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":15,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@SanitisedFileNameOnly","Value":"[Format,@SanitisedFileNameOnly,action,{replace:char(91),(}]","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":16,"Level":0,"Parameters":{"Name":"LastImageIndex","Query":"select count(assetid) as AssetCount, max(indexNo) as LastIndex from Ufiler_2AM_ArticleAssetData where ArticleID = [ID,form] and AssetName like '[@SanitisedFileNameOnly,action]%[frmfile.extension,form]'","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":17,"Level":0,"Parameters":{"LeftCondition":"[AssetCount,LastImageIndex]","RightCondition":"0","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":18,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@NewIndex","Value":"","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":19,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@FileNameNewIndex","Value":"","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":20,"Level":0,"Parameters":{"LeftCondition":"'[LastIndex,LastImageIndex]'","RightCondition":"''","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":21,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@NewIndex","Value":"1","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":22,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@FileNameNewIndex","Value":"([@NewIndex,Action])","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":23,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":24,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@NewIndex","Value":"{MATH, \"[LastIndex,LastImageIndex]+1\"}","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":25,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@FileNameNewIndex","Value":"([@NewIndex,Action])","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]}]},{"Index":26,"Level":0,"Parameters":{"Value":"*** Upload the file into a temporary area with the sanitised name and index number ***"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":27,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@FileTempDestination","Value":"/portals/[PortalID,system]/Ufiler_2AM/temp/ArticleAsset/[ID,Form]/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form]","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":28,"Level":0,"Parameters":{"SourceType":"Variable","SourceVariableType":"&lt;Form&gt;","Source":"frmFile","SourceQuery":"","DestinationType":"Path","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"[@FileTempDestination,Action]","TransformType":"","ImageTransformType":"Size","ImageFont":"","ImageSize":"","ImageSizeType":"px","ImageColor":"","ImageBGColor":"","ImageWidth":"","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"compress","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]},{"Index":29,"Level":0,"Parameters":{"Value":"A few things are happening here:\n1. Inserting the record Directionectly into the database - this is done using a standard Query action and the use of the Hex value of the form field.\n\tOWS supports the ability to convert the file stream Directionectly into HEX (which is the native binary format of SQL), so:\n\ta. frmFile is the name of the form element. It's contents are typically pulled from [frmFile,Form] as expected.\n\tb. [frmFile.Name,Form] gets the Name of the file element.\n\tc. [frmFile.Type,Form] gets the Mime Type of the file element.\n\td. [frmFile.Hex,Form] gets the physical binary data of the file in Hex format.\n\te. [$frmFile:Form,{FILE.IMAGE}] returns True or False depending on whether the file is in fact an image.\n2. The file is inserted into the /File.Example/Upload/ folder under its original file name.\n3. The file is inserted into the /File.Example/Compressed/ folder under its original file name with .zip appended.\n4. If the file is an Image, a thumbnail 64px Wide by the incoming ratio Tall will be created in /File.Example/Thumbnail/ with .thumb.jpg as the extension "},"ActionType":"Action-Comment","ChildActions":[{"Index":30,"Level":0,"Parameters":{"LeftCondition":"'[COALESCE,\"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form]\",Text,{MAPPATH},{FILE.IMAGE}]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":31,"Level":0,"Parameters":{"SourceType":"Path","SourceVariableType":"&lt;Form&gt;","Source":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form]","SourceQuery":"","DestinationType":"Path","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/Thumbnails/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form].thumb.jpg","TransformType":"Image","ImageTransformType":"Size","ImageFont":"","ImageSize":"","ImageSizeType":"px","ImageColor":"","ImageBGColor":"","ImageWidth":"80","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"compress","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]},{"Index":32,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ThumbnailPath","Value":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/Thumbnails/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form].thumb.jpg","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]}]},{"Index":33,"Level":0,"Parameters":{"LeftCondition":"'[|coalesce,\"/portals/[PortalID,system]/Ufiler_2AM/temp/ArticleAsset/[ID,Form]/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form]\",Text,{MAPPATH},{FILE.IMAGE}]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":34,"Level":0,"Parameters":{"SourceType":"Path","SourceVariableType":"&lt;Form&gt;","Source":"/portals/[PortalID,system]/Ufiler_2AM/temp/ArticleAsset/[ID,Form]/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form]","SourceQuery":"","DestinationType":"Path","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/Thumbnails/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form].thumb.jpg","TransformType":"Image","ImageTransformType":"Size","ImageFont":"","ImageSize":"","ImageSizeType":"px","ImageColor":"","ImageBGColor":"","ImageWidth":"80","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"compress","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]},{"Index":35,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ThumbnailPath","Value":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/Thumbnails/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form].thumb.jpg","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":36,"Level":0,"Parameters":{"LeftCondition":"'[frmFile.Type,Form]'='application/excel' or '[frmFile.Type,Form]'='application/vnd.ms-excel' or '[frmFile.Type,Form]'='application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' or '[frmFile.Type,Form]'='application/x-excel' or '[frmFile.Type,Form]'='application/x-msexcel'","RightCondition":"Right Condition","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":37,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ThumbnailPath","Value":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/excel04-80.png","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":38,"Level":0,"Parameters":{"LeftCondition":"'[frmFile.Type,Form]'='application/powerpoint' or '[frmFile.Type,Form]'='application/mspowerpoint' or '[frmFile.Type,Form]'='application/vnd.ms-powerpoint'","RightCondition":"Right Condition","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":39,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ThumbnailPath","Value":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/powerpoint08-80.png","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":40,"Level":0,"Parameters":{"LeftCondition":"'[frmFile.Type,Form]'='application/msword' or '[frmFile.Type,Form]'='application/vnd.openxmlformats-officedocument.wordprocessingml.document'","RightCondition":"Right Condition","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":41,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ThumbnailPath","Value":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/word01-80.png","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":42,"Level":0,"Parameters":{"LeftCondition":"'[frmFile.Type,Form]'='application/pdf'","RightCondition":"Right Condition","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":43,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ThumbnailPath","Value":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/acrobat-80.png","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":44,"Level":0,"Parameters":{"LeftCondition":"'[frmFile.Type,Form]'='text/plain'","RightCondition":"Right Condition","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":45,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ThumbnailPath","Value":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/notepad-80.png","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":46,"Level":0,"Parameters":{"Name":"INSERT","Query":"INSERT INTO Ufiler_2AM_ArticleAssetData(ModuleID,AssetName,ArticleID,IndexNo,MimeType,ThumbnailPath,Data, dateuploaded)\nValues ('[ModuleID,system]','[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form]',[ID,Form],'[@NewIndex,action]','[frmFile.Type,Form]','[ThumbnailPath,Action]',[frmFile.Hex,Form], '[Date,system]')","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":47,"Level":0,"Parameters":{"Value":"Place Comment Here"},"ActionType":"Action-Comment","ChildActions":[{"Index":48,"Level":0,"Parameters":{"SourceType":"Variable","SourceVariableType":"&lt;Form&gt;","Source":"frmFile","SourceQuery":"","DestinationType":"Path","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/Compressed/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form].zip","TransformType":"File","ImageTransformType":"Size","ImageFont":"","ImageSize":"","ImageSizeType":"px","ImageColor":"","ImageBGColor":"","ImageWidth":"","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"compress","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]},{"Index":49,"Level":0,"Parameters":{"SourceType":"Variable","SourceVariableType":"&lt;Form&gt;","Source":"frmFile","SourceQuery":"","DestinationType":"Path","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/[@SanitisedFileNameOnly,action][@FileNameNewIndex,action][frmFile.Extension,Form]","TransformType":"","ImageTransformType":"Size","ImageFont":"","ImageSize":"","ImageSizeType":"px","ImageColor":"","ImageBGColor":"","ImageWidth":"","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"compress","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]}]}]},{"Index":50,"Level":0,"Parameters":{"LeftCondition":"'[frmGo,Form]'","RightCondition":"'Delete Asset'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":51,"Level":0,"Parameters":{"Value":"An IF CONDITION is used to check to see if the chkFile value from the form contains a comma \",\". If it does, more than one box was checked and we must compress the result, otherwise only one was present\n\nIf one file is selected, the returned result is the single uncompressed file (from the database). Pay close attention here - to replace the FILENAME,FILE and CONTENTTYPE,FILE from the columns\nin the result, you MUST set the transformation to FILE COPY. That way you can copy the file from the source (SQL) to the Destination (PATH OR RESPONSE). The Data Column is automatically inferred\nas the binary data. Additional columns also control the specific replaced values in those attributes:\n\n1. Filecontent, Content, Image, Source and Data all are processed as the binary data column automatically (when not present, index 0 is used).\n2. Name, Filename are used as the [FILENAME,FILE] value.\n3. ContentType, Mime, Type and MimeType are handled by the [CONTENTTYPE,FILE] value.\n5. Ext, Extension are handled by the [EXTENSION,FILE] value.\n\nIf more than one file is selected, the download result is a compressed library of all checked files. - A final action deletes the Folder that was created to produce the compressed library.\n"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":52,"Level":0,"Parameters":{"Value":"Execute a query and download the files based on the file id (we use [chkFile,Form:number list] \nbecause it checks each value and makes sure it is a number and when it is not a number it throws out the value).\n\nEach resulting record is then transferred down to the file system using the file action."},"ActionType":"Action-Comment","ChildActions":[]},{"Index":53,"Level":0,"Parameters":{"Name":"BATCH","Query":"--RETURN THE LIST OF FILES FROM THE DATABASE\nSELECT AssetID,AssetName from Ufiler_2AM_ArticleAssetData where AssetID in ([chkFile,Form:number list])\n\n--DELETE THE FILES FROM THE DATABASE NOW\nDELETE from Ufiler_2AM_ArticleAssetData where AssetID in ([chkFile,Form:number list])","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":54,"Level":0,"Parameters":{"SourceType":"Path","SourceVariableType":"&lt;Form&gt;","Source":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/Thumbnails/[AssetName,BATCH].thumb.jpg","SourceQuery":"Select Data from FileData where FileID = [FileID,BATCH]","DestinationType":"","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"[CONTENTTYPE,FILE]","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"","TransformType":"File","ImageWidth":"","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"delete","ImageTransformType":"Size","ImageFont":"","ImageColor":"","ImageBGColor":"","ImageSize":"","ImageSizeType":"px","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]},{"Index":55,"Level":0,"Parameters":{"SourceType":"Path","SourceVariableType":"&lt;Form&gt;","Source":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/Compressed/[AssetName,BATCH].zip","SourceQuery":"Select Data from FileData where FileID = [FileID,BATCH]","DestinationType":"","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"[CONTENTTYPE,FILE]","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"","TransformType":"File","ImageWidth":"","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"delete","ImageTransformType":"Size","ImageFont":"","ImageColor":"","ImageBGColor":"","ImageSize":"","ImageSizeType":"px","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]},{"Index":56,"Level":0,"Parameters":{"SourceType":"Path","SourceVariableType":"&lt;Form&gt;","Source":"/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,system]/[ID,Form]/[AssetName,BATCH]","SourceQuery":"Select Data from FileData where FileID = [FileID,BATCH]","DestinationType":"","DestinationVariableType":"&lt;Session&gt;","DestinationResponseType":"[CONTENTTYPE,FILE]","SQLFirstRow":"false","ColumnMappings":"","DestinationQuery":"","RunAsProcess":"false","ProcessName":"","Destination":"","TransformType":"File","ImageWidth":"","ImageWidthType":"px","ImageHeight":"","ImageHeightType":"px","ImageQuality":"90","XMLReadPath":"","XMLWritePath":"","FileTask":"delete","ImageTransformType":"Size","ImageFont":"","ImageColor":"","ImageBGColor":"","ImageSize":"","ImageSizeType":"px","ImageWarp":"","ImageText":"","ImageX":"0","ImageY":"0","SourceConnection":""},"ActionType":"Action-File","ChildActions":[]}]}]}]},{"Index":57,"Level":0,"Parameters":{"Name":"Query Variables","RenderType":"0","skipDebug":"False","includeSearch":"False","includeExport":"False","includeImport":"False"},"ActionType":"Action-Region","ChildActions":[{"Index":58,"Level":0,"Parameters":{"VariableType":"<QueryString>","VariableDataType":"Any","Formatters":"","QuerySource":"Action","QueryTarget":"@Action","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"'ShowActive'","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":59,"Level":0,"Parameters":{"VariableType":"<Form>","QuerySource":"frmArticleStatus","QueryTarget":"@ArticleStatus","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true","VariableDataType":"Any","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":60,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmArticleStatusID","QueryTarget":"@ArticleStatusID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":61,"Level":0,"Parameters":{"VariableType":"<Form>","QuerySource":"frmAuthor","QueryTarget":"@Author","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true","VariableDataType":"Any","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":62,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmAuthor","QueryTarget":"@AuthorID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":63,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","QuerySource":"fltCategory","QueryTarget":"@Category_Filter","QueryTargetLeft":"a.CategoryID='","QueryTargetRight":"'","QueryTargetEmpty":"1=1","EscapeListX":"0","Protected":"true","EscapeHTML":"true","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":64,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmArticleCategory","QueryTarget":"@CategoryID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":65,"Level":0,"Parameters":{"VariableType":"<Form>","QuerySource":"frmCategory","QueryTarget":"@Category","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true","VariableDataType":"Any","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":66,"Level":0,"Parameters":{"VariableType":"<QueryString>","VariableDataType":"Any","Formatters":"","QuerySource":"urpp","QueryTarget":"@ChangeUserRecsPerPage","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":67,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmCommissioner","QueryTarget":"@Commissioner","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":68,"Level":0,"Parameters":{"VariableType":"<QueryString>","VariableDataType":"Any","Formatters":"","QuerySource":"Direction","QueryTarget":"@Direction","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":69,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmEventID","QueryTarget":"@EventID","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":70,"Level":0,"Parameters":{"VariableType":"<Form>","QuerySource":"frmForename","QueryTarget":"@Forename","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true","VariableDataType":"Any","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":71,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"ID","QueryTarget":"@frmID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":72,"Level":0,"Parameters":{"VariableType":"<QueryString>","VariableDataType":"Number","Formatters":"","QuerySource":"ID","QueryTarget":"@ID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":73,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmInsertWhere","QueryTarget":"@InsertWhere","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":74,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmLeagueName","QueryTarget":"@LeagueName","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":75,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmNotes","QueryTarget":"@Notes","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"''","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":76,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","QuerySource":"fltOwner","QueryTarget":"@Owner_Filter","QueryTargetLeft":"OwnerID= '","QueryTargetRight":"'","QueryTargetEmpty":"1=1","EscapeListX":"0","Protected":"true","EscapeHTML":"true","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":77,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmOwnerID","QueryTarget":"@OwnerID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":78,"Level":0,"Parameters":{"VariableType":"<QueryString>","VariableDataType":"Number","Formatters":"","QuerySource":"PageNumber","QueryTarget":"@PageNumber","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"1","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":79,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmPages","QueryTarget":"@Pages","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"0","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":80,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmPublication","QueryTarget":"@Publication","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":81,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmPublished","QueryTarget":"@Published","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":82,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","QuerySource":"fltPublished","QueryTarget":"@Published_Filter","QueryTargetLeft":"Published='","QueryTargetRight":"'","QueryTargetEmpty":"1=1","EscapeListX":"0","Protected":"true","EscapeHTML":"true","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":83,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmPublishedTitle","QueryTarget":"@PublishedTitle","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":84,"Level":0,"Parameters":{"VariableType":"<Form>","QuerySource":"frmReleasable","QueryTarget":"@Releasable","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true","VariableDataType":"Boolean","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":85,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmReleasedArticle","QueryTarget":"@ReleasedArticle","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":86,"Level":0,"Parameters":{"VariableType":"<Form>","QuerySource":"frmReviewer","QueryTarget":"@Reviewer","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true","VariableDataType":"Any","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":87,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmReviewerID","QueryTarget":"@ReviewerID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":88,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmScheduledFor","QueryTarget":"@ScheduledFor","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":89,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","QuerySource":"fltScheduledFor","QueryTarget":"@ScheduledFor_Filter","QueryTargetLeft":"ScheduledFor='","QueryTargetRight":"'","QueryTargetEmpty":"1=1","EscapeListX":"0","Protected":"true","EscapeHTML":"true","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":90,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","QuerySource":"fltStatus","QueryTarget":"@Status_Filter","QueryTargetLeft":"a.StatusID='","QueryTargetRight":"'","QueryTargetEmpty":"1=1","EscapeListX":"0","Protected":"true","EscapeHTML":"true","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":91,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","Formatters":"","QuerySource":"frmSubject","QueryTarget":"@Subject","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"'No Subject Supplied'","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":92,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","QuerySource":"fltSubject","QueryTarget":"@fltSubject","QueryTargetLeft":"subject like '%","QueryTargetRight":"%'","QueryTargetEmpty":"1=1","EscapeListX":"0","Protected":"true","EscapeHTML":"true","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":93,"Level":0,"Parameters":{"VariableType":"<Form>","QuerySource":"frmSurname","QueryTarget":"@Surname","QueryTargetLeft":"'","QueryTargetRight":"'","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true","VariableDataType":"Any","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":94,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"selArticlesPerPage","QueryTarget":"@UserRecsPerPage","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"NULL","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":95,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Any","QuerySource":"fltWrittenBy","QueryTarget":"@WrittenBy_Filter","QueryTargetLeft":"WrittenByID='","QueryTargetRight":"'","QueryTargetEmpty":"1=1","EscapeListX":"0","Protected":"true","EscapeHTML":"true","Formatters":""},"ActionType":"Template-Variable","ChildActions":[]},{"Index":96,"Level":0,"Parameters":{"VariableType":"<Form>","VariableDataType":"Number","Formatters":"","QuerySource":"frmWrittenByID","QueryTarget":"@WrittenByID","QueryTargetLeft":"","QueryTargetRight":"","QueryTargetEmpty":"","EscapeListX":"0","Protected":"true","EscapeHTML":"true"},"ActionType":"Template-Variable","ChildActions":[]},{"Index":97,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@ID","Value":"[coalesce,@frmID,variable,@ID,variable,NULL,text]","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":98,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"CanAdminister","Value":"False","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":99,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Footer","Value":"</table>\n<hr />\n[@Pager,Action]\n</div></div>","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":100,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Pager","Value":"<div style=\"float:left;\">\n{PAGER,\nCurrent=\"[Ufiler_CurrentPage,Table1]\",\nPages=\"{MATH,\"CEIL([Ufiler_TotalRows,Table6]/[Ufiler_RecordsPerPage,Table4])\"}\",\nShow=\"[Ufiler_NumberOfPageLinks,Table5]\",\nFormat=\"<span class=\\\"PagingLink\\\"><a href=\\\"#\\\" onclick=\\\"ows.Fetch('[ModuleID,System]','-1','Action=\\[coalesce,@Action,variable,\\\"\\{replace:',\\}\\\"\\]&PageNumber=#PAGE#');return false;\\\">#PAGE#</a></span>\",\nCurrentFormat=\"<span class=\\\"PagingLink ActiveLink\\\"><a href=\\\"#\\\" onclick=\\\"ows.Fetch('[ModuleID,System]','-1','Action=\\[coalesce,@Action,variable,\\\"\\{replace:',\\}\\\"\\]&PageNumber=#PAGE#');return false;\\\">#PAGE#</a></span>\",\nPageDelimiter=\"\",\nDelimiter=\"\",\nLeftFormat=\"<span class=\\\"PagingLink\\\"><a href=\\\"#\\\" onclick=\\\"ows.Fetch('[ModuleID,System]','-1','Action=\\[coalesce,@Action,variable,\\\"\\{replace:',\\}\\\"\\]&PageNumber=1');return false;\\\"> First</a></span><span class=\\\"PagingLink\\\"><a href=\\\"#\\\" onclick=\\\"ows.Fetch('[ModuleID,System]','-1','Action=\\[coalesce,@Action,variable,\\\"\\{replace:',\\}\\\"\\]&PageNumber=[Ufiler_PreviousPage,Table2]');return false;\\\"> BACK</a></span>\",\nDisabledLeftFormat=\"<span class=\\\"PagingLink DisabledLink\\\"> First</span><span class=\\\"PagingLink DisabledLink\\\"> BACK</span>\",\nRightFormat=\"<span class=\\\"PagingLink\\\"><a href=\\\"#\\\" onclick=\\\"ows.Fetch('[ModuleID,System]','-1','Action=\\[coalesce,@Action,variable,\\\"\\{replace:',\\}\\\"\\]&PageNumber=[Ufiler_NextPage,Table3]');return false;\\\">NEXT </a></span><span class=\\\"PagingLink\\\"><a href=\\\"#\\\" onclick=\\\"ows.Fetch('[ModuleID,System]','-1','Action=\\[coalesce,@Action,variable,\\\"\\{replace:',\\}\\\"\\]&PageNumber={MATH,\"CEIL([Ufiler_TotalRows,Table6]/[Ufiler_RecordsPerPage,Table4])\"}');return false;\\\">Last </a></span>\",\nDisabledRightFormat=\"<span class=\\\"PagingLink DisabledLink\\\">NEXT </span><span class=\\\"PagingLink DisabledLink\\\">Last </span>\",\nEmptyFormat=\"\"\n}\n</div>","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":101,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@RecsPerPage","Value":"<div style=\"float:right;\">Records per Page:\n<select id=\"selArticlesPerPage\" name=\"selArticlesPerPage\"  onchange=\"ows.fetch([moduleid,system],0,'Action=[coalesce,@Action,variable,\"{replace:',}\"]&urpp=y');\">\n\t<option value=\"0\" {IIF, \"'[@UserRecsPerPage,session]'='0'\", \"selected=\\\"selected\\\"\",\"\"}>All</option>\n\t<option value=\"10\" {IIF, \"'[@UserRecsPerPage,session]'='10'\", \"selected=\\\"selected\\\"\",\"\"}>10</option>\n\t<option value=\"15\" {IIF, \"'[@UserRecsPerPage,session]'='15'\", \"selected=\\\"selected\\\"\",\"\"}>15</option>\n\t<option value=\"20\" {IIF, \"'[@UserRecsPerPage,session]'='20'\", \"selected=\\\"selected\\\"\",\"\"}>20</option>\n\t<option value=\"25\" {IIF, \"'[@UserRecsPerPage,session]'='25'\", \"selected=\\\"selected\\\"\",\"\"}>25</option>\n</select>\n</div>","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":102,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Search","Value":"<div style=\"float:left;\"><input id=\"fltSubject\" name=\"fltSubject\" onkeyup=\"ows.Fetch([ModuleID,system],0,'Action=DoSearch','SResult');\" placeholder=\"Search Titles Here\" /></div>","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":103,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@SQLHeader","Value":"DECLARE @Ufiler_CurrentPage INT;\nDECLARE @Ufiler_RecordsPerPage INT;\nDECLARE @Ufiler_NumberOfPageLinks INT;\nDECLARE @Ufiler_PageNumberQuerystring VARCHAR;\n\nSET @Ufiler_CurrentPage = @PageNumber;\nSET @Ufiler_RecordsPerPage = {IIF, \"[@UserRecsPerPage,session]=0\", \"99999\", \"[@UserRecsPerPage,session]\"};\nSET @Ufiler_NumberOfPageLinks = 9;\n\n\nWITH Ufiler_MyQuery AS\n(","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":104,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@SQLPagerSelects","Value":")\n\nSELECT * FROM Ufiler_MyQuery WHERE RowNumber BETWEEN  ( (@Ufiler_CurrentPage -1) * @Ufiler_RecordsPerPage) + 1 AND ( @Ufiler_CurrentPage * @Ufiler_RecordsPerPage )\n\n\n--Table1\nSELECT @Ufiler_CurrentPage AS Ufiler_CurrentPage\n\n--Table2\nSELECT @Ufiler_CurrentPage - 1 AS Ufiler_PreviousPage\n\n--Table3\nSELECT @Ufiler_CurrentPage + 1 AS Ufiler_NextPage\n\n--Table4\nSELECT @Ufiler_RecordsPerPage AS Ufiler_RecordsPerPage\n\n--Table5\nSELECT @Ufiler_NumberOfPageLinks AS Ufiler_NumberOfPageLinks\n\n--Table6\nSELECT count(*) AS Ufiler_TotalRows \n","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":105,"Level":0,"Parameters":{"Name":"Ufiler_Functions","Region":"Module Settings","ConfigurationID":"9a5a92e9-23e2-406c-ac18-c94a244606d9"},"ActionType":"Action-Goto","ChildActions":[]},{"Index":106,"Level":0,"Parameters":{"Name":"Is2AMAdmin","Query":"select COUNT(*) as 'isTrue' from UserRoles\nwhere UserID=[UserID,system] and RoleID = [2AM_ManagerRoleID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":107,"Level":0,"Parameters":{"LeftCondition":"[isTrue,Is2AMAdmin]>0 or [Format,,{ISSUPERUSER}]=True","RightCondition":"0","Operator":">","IsAdvanced":"True"},"ActionType":"Condition-If","ChildActions":[{"Index":108,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"CanAdminister","Value":"True","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]}]},{"Index":109,"Level":0,"Parameters":{"Name":"Actions Before Render","RenderType":"2","skipDebug":"false","includeSearch":"false","includeExport":"false","includeImport":"false"},"ActionType":"Action-Region","ChildActions":[{"Index":110,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = NULL or [@Action,variable] = 'ShowActive'","RightCondition":"Right Condition","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-If","ChildActions":[]},{"Index":111,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'UpdateArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":112,"Level":0,"Parameters":{"Name":"UpdateArticle","Query":"update Ufiler_2AM_Article \nset\tSubject = [@Subject,variable]\n\t,OwnerID = '[@OwnerID,variable]'\n\t,StatusID = '[@ArticleStatusID,variable]'\n\t,WrittenByID = '[@WrittenByID,variable]'\n\t,ScheduledFor = '[@ScheduledFor,variable]'\n\t,notes = [@Notes,variable] \n\t,CategoryID = [@CategoryID,variable] \nwhere articleID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":113,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'ReleaseArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":114,"Level":0,"Parameters":{"Name":"ReleaseArticleArticle","Query":"update Ufiler_2AM_Article set [Released] = '[FORMAT,[Date,system],{0:dd MMM yyyy}]' where ArticleID=[@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":115,"Level":0,"Parameters":{"LeftCondition":"'[MailEnabled,ModuleSettings]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":116,"Level":0,"Parameters":{"Name":"ArticleDetails","Query":"select a.[subject], d.ShortMonthName + '-' + d.FullYear as Scheduled\nfrom Ufiler_2AM_Article a\n\tleft join Ufiler_Datelookup d\n\ton a.ScheduledFor = d.DateKey\n","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":117,"Level":0,"Parameters":{"Name":"NotifyReleased","Query":"select coalesce(n.emailaddress,u.emailaddress) as emailaddress, u.displayname as ToName\nfrom Ufiler_2AM_notification n\n\tleft join Users u on n.Userid=u.UserID\nwhere n.moduleID = [moduleID,system]\nand n.articlereleased ='1'","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":118,"Level":0,"Parameters":{"From":"2AM@sweeneys.net","To":"[emailaddress]","Cc":"","Bcc":"","Format":"html","Subject":"Article released for Publication","Body":"<p>Hello [ToName],</p>\n<p>The following Article has been released for publication by [Username]:</p/>\n<p>&nbsp;</p>\n<p>Subject: [Subject,ArticleDetails]</p>\n<p>Scheduled For: [Scheduled,ArticleDetails]<p>\n","ResultVariableType":"&lt;Session&gt;","ResultVariableName":"","SMTPServer":"","SMTPUsername":"","SMTPPassword":"","SMTPAuthType":"","SMTPSSL":"false"},"ActionType":"Action-Email","ChildActions":[]}]}]}]},{"Index":119,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'InsertArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":120,"Level":0,"Parameters":{"Name":"InsertArticle","Query":"insert into Ufiler_2AM_Article(ModuleID, Subject, categoryID, OwnerID,StatusID,WrittenByID,ScheduledFor,notes)\nvalues('[ModuleID,system]',[@Subject,variable],'[@CategoryID,variable]','[@OwnerID,variable]','[@ArticleStatusID,variable]','[@WrittenByID,variable]','[@ScheduledFor,variable]',[@Notes,variable])","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":121,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'UpdateReleasedArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":122,"Level":0,"Parameters":{"Name":"UpdateReleasedArticle","Query":"update Ufiler_2AM_Article \nset\tPages = '[@Pages,variable]'\n\t,ScheduledFor = '[@ScheduledFor,variable]'\n\t,Published = '[@Published,variable]'\n\t,PublishedTitle = [@PublishedTitle,variable]\nwhere articleID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":123,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'RecallArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":124,"Level":0,"Parameters":{"Name":"ReleaseArticleArticle","Query":"update Ufiler_2AM_Article set [Released] = NULL where ArticleID=[@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":125,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'InsertStatus'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":126,"Level":0,"Parameters":{"LeftCondition":"[@ID,Action]","RightCondition":"0","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":127,"Level":0,"Parameters":{"Name":"InsertStatus","Query":"insert into Ufiler_2AM_ArticleStatus(ModuleID,Status,Releasable,SeqNo)\nvalues([ModuleID,system],[@ArticleStatus,variable],[@Releasable,variable],'1')","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":128,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":129,"Level":0,"Parameters":{"Name":"InsertStatusAt","Query":"declare @CurPos int\nset @CurPos = (select SeqNo from Ufiler_2AM_ArticleStatus where StatusID = [@ID,Action])\nIf [@InsertWhere,variable] = 'before' --insert before\n\tbegin\n\t\tUpdate Ufiler_2AM_ArticleStatus set SeqNo = SeqNo + 1 where ModuleID = [ModuleID,system] and SeqNo >= @CurPos\t\n\t\tInsert into Ufiler_2AM_ArticleStatus(ModuleID,Status,Releasable,SeqNo) Values([ModuleID,system],[@ArticleStatus,variable],[@Releasable,variable],@CurPos)\n\tend\nelse\t\t\t\t-- Insert after\n\tbegin\n\t\tUpdate Ufiler_2AM_ArticleStatus set SeqNo = SeqNo + 1 where ModuleID = [ModuleID,system] and SeqNo > @CurPos\n\t\tInsert into Ufiler_2AM_ArticleStatus(ModuleID,Status,Releasable,SeqNo) Values([ModuleID,system],[@ArticleStatus,variable],[@Releasable,variable],@CurPos+1)\n\tend\n","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]}]},{"Index":130,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'UpdateStatus'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":131,"Level":0,"Parameters":{"Name":"UpdateStatus","Query":"update Ufiler_2AM_ArticleStatus Set Status = [@ArticleStatus,variable], Releasable = [@Releasable,variable] where StatusID= [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":132,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'MoveStatus'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":133,"Level":0,"Parameters":{"LeftCondition":"[@Direction,variable]","RightCondition":"'up'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":134,"Level":0,"Parameters":{"Name":"MovePriorStatusDownAndCurrentStatusUp","Query":"update Ufiler_2AM_ArticleStatus \n\tset SeqNo = SeqNo + 1 \n\twhere SeqNo = (select SeqNo from Ufiler_2AM_ArticleStatus where StatusID = [@ID,Action]) -1\nupdate Ufiler_2AM_ArticleStatus \n\tset SeqNo = SeqNo - 1 \n\twhere StatusID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":135,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":136,"Level":0,"Parameters":{"Name":"MoveFollowingStatusUpAnd CurrentStatusDown","Query":"update Ufiler_2AM_ArticleStatus \n\tset SeqNo = SeqNo - 1 \n\twhere SeqNo = (select SeqNo from Ufiler_2AM_ArticleStatus where StatusID = [@ID,Action]) +1\nupdate Ufiler_2AM_ArticleStatus \n\tset SeqNo = SeqNo + 1 \n\twhere StatusID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]}]},{"Index":137,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'DeleteStatus'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":138,"Level":0,"Parameters":{"Name":"DelStatus","Query":"delete from Ufiler_2AM_ArticleStatus where StatusID=[@ID,Action]\n-- Close up gaps\nIF OBJECT_ID('tempdb..#Seqno') IS NOT NULL\n\tDROP TABLE [dbo].[#Seqno]\nCREATE TABLE #Seqno(\n\t[ID] [int] IDENTITY(1,1) NOT NULL,\n\t[oldID] [int] NOT NULL,\n\t[SeqNo] [int] NOT NULL\n)\ninsert into #Seqno (oldID,SeqNo) select c.StatusID, c.SeqNo from Ufiler_2AM_ArticleStatus c\nwhere ModuleID=[ModuleID,system] order by c.seqno\nselect * from Ufiler_2AM_ArticleStatus\nselect * from #Seqno\nupdate Ufiler_2AM_ArticleStatus set SeqNo = ID\n\tfrom #Seqno s \n\t\tinner join Ufiler_2AM_ArticleStatus c \n\t\t\ton s.[oldID] = c.StatusID","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":139,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'InsertPerson'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":140,"Level":0,"Parameters":{"Name":"InsertPerson","Query":"insert into Ufiler_2AM_Person(ModuleID,Forename,Surname,Commissioner,Author,Reviewer)\nvalues([ModuleID,system],@Forename,@Surname,@Commissioner,@Author,@Reviewer)","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":141,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'Admin' or [@Action,variable] = 'ShowStats'","RightCondition":"'Admin'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":142,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":143,"Level":0,"Parameters":{"Value":"Set up Category display for Manager"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":144,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayCategory","Value":"<div id=\"dvCategory\" style=\"float:left;width:32%;\">\n<h3>Category</h3>\n<button type=\"button\" onclick=\"javascript:ows.fetch([moduleID,system],-1,'Action=AddCategory','dvCategory');\">Add A New Category</button>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"border:0;width:98%\">\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":145,"Level":0,"Parameters":{"Name":"getCategory","Query":"select c.CategoryID, c.Category, c.SeqNo, (select max(SeqNo) from  Ufiler_2AM_ArticleCategory where PublicationID= '1' ) as MaxOrderCat, (select min(SeqNo) from  Ufiler_2AM_ArticleCategory Where PublicationID = '1')  as MinOrderCat, count(a.CategoryID) as CategoryCount \nfrom Ufiler_2AM_ArticleCategory c  left join Ufiler_2AM_Article a on c.CategoryID= a.CategoryID\nWhere c.PublicationID= '1'\nGroup by c.CategoryID, c.Category, c.SeqNo \norder by c.SeqNo, c.Category","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":146,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayCategory","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditCategory&ID=[CategoryID,getCategory]','dvCategory');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"1\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"[SeqNo,getCategory]<[MaxOrderCat,getCategory]\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveCategory&ID=\\[CategoryId,getCategory]&Direction=down','dvCategory')\\\"><img src='/images/dn.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td class=\"iconcol\">{IIF, \"[SeqNo,getCategory]>[MinOrderCat,getCategory]\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveCategory&ID=\\[CategoryId,getCategory]&Direction=up','dvCategory')\\\"><img src='/images/up.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td>[Category,getCategory] {IIF, \"[CategoryCount,getCategory]>0\",\"([CategoryCount,getCategory])\",\"<a href=\\\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeleteCategory&ID=[CategoryID,getCategory]','dvCategory');\\\" onclick=\\\"return confirm('Are you sure that you want to delete &quot;[Category,getCategory]&quot;? \\nThis action can not be undone.');\\\"><img src=\\\"/images/delete.gif\\\" alt=\\\"Delete\\\" border=\\\"0\\\" /></a>\"}</td>\n</tr>\n","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":147,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayCategory","Value":"</table></div>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":148,"Level":0,"Parameters":{"Value":"Set up Person display for Manager"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":149,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPerson","Value":"<div id=\"dvPerson\" style=\"float:left;width:32%; border:0px solid #efad1b\">\n<h3>People</h3>\n<button type=\"button\" onclick=\"javascript:ows.fetch([moduleID,system],-1,'Action=AddPerson','dvPerson');\">Add A New Person</button>\n<table cellspacing=\"1\" cellpadding=\"1\"  style=\"width:98%;border:0\">\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":150,"Level":0,"Parameters":{"Name":"getPerson","Query":"select p.PersonID, p.surname, p.forename, (select count(ownerID) from Ufiler_2AM_Article where OwnerID = p.PersonID) as OwnerCount, (select count(WrittenByID) from Ufiler_2AM_Article where WrittenByID = p.PersonID)as WriterCount\nfrom Ufiler_2AM_Person p  \n\tleft join Ufiler_2AM_Article a on p.PersonID = a.OwnerID \n\tleft join Ufiler_2AM_Article b on p.PersonID = b.WrittenByID\nWhere a.PublicationID= '1'\nGroup by p.PersonID, p.surname, p.forename \norder by p.surname","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":151,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPerson","Value":"<tr valign=\"top\">\n<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditPerson&ID=[PersonID,getPerson]','dvPerson');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td style=\"text-align:left\">[surname,getPerson], [forename,getPerson] &nbsp;\n{IIF, \"[OwnerCount,getPerson]>0 OR [WriterCount,getPerson]>0\",\"([WriterCount,getPerson])\",\"<a href=\\\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeletePerson&ID=[PersonID,getPerson]','dvPerson');\\\" onclick=\\\"return confirm('Are you sure that you want to delete [surname,getPerson], [forename,getPerson]? nThis action can not be undone.');\\\"><img src=\\\"/images/delete.gif\\\" alt=\\\"Delete\\\" border=\\\"0\\\" /></a>\"}</td>\n</tr>\n","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":152,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPerson","Value":"</table></div>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":153,"Level":0,"Parameters":{"Value":"Set up Status display for Manager"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":154,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayStatus","Value":"<div id=\"dvStatus\" style=\"float:left;width:32%; border:0px solid #efad1b\">\n<h3>Status</h3>\n<button type=\"button\" onclick=\"javascript:ows.fetch([moduleID,system],-1,'Action=AddStatus','dvStatus');\">Add A New Status</button>\n<table cellspacing=\"1\" cellpadding=\"1\"  style=\"width:98%;border:0\">\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":155,"Level":0,"Parameters":{"Name":"getStatus","Query":"select s.statusID, s.status, s.Releasable, s.SeqNo, (select max(SeqNo) from  Ufiler_2AM_ArticleStatus Where PublicationID = '1') as MaxOrder, (select min(SeqNo) from  Ufiler_2AM_ArticleStatus Where PublicationID = '1')  as MinOrder, count(a.statusID) as StatusCount \nfrom Ufiler_2AM_ArticleStatus s  left join Ufiler_2AM_Article a on s.statusID= a.StatusID\nWhere s.PublicationID = '1'\nGroup by s.statusID, s.status, s.Releasable, s.SeqNo \norder by s.SeqNo, s.status","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":156,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayStatus","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditStatus&ID=[StatusID,getStatus]','dvStatus');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo,getStatus]'<'[MaxOrder,getStatus]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveStatus&ID=\\[StatusId,getStatus]&Direction=down,'dvStatus'')\\\"><img src='/images/dn.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo,getStatus]'>'[MinOrder,getStatus]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveStatus&ID=\\[StatusId,getStatus]&Direction=up','dvStatus')\\\"><img src='/images/up.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Status,getStatus]{IIF, \"'[Releasable,getStatus]'='True'\", \"<span style='font-size:smaller'>(R)</span>\", \"\"} &nbsp;\n\t{IIF, \"[StatusCount,getStatus]>0\",\"([StatusCount,getStatus])\",\"<a href=\\\"javascript:ows.Fetch([ModuleId,system],0,'Action=DelStatus&ID=[StatusID,getStatus]');\\\" onclick=\\\"return confirm('Are you sure that you want to delete &quot;[Status,getStatus]&quot;? \\nThis action can not be undone.');\\\"><img src=\\\"/images/delete.gif\\\" alt=\\\"Delete\\\" border=\\\"0\\\" /></a>\"}</td>\n</tr>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":157,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayStatus","Value":"</table></div>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":158,"Level":0,"Parameters":{"Value":"Set up Publication for manager"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":159,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPublication","Value":"<div id=\"dvPublication\" style=\"float:left;width:32%; border:0px solid #efad1b\">\n<h3>Publications</h3>\n<button type=\"button\" onclick=\"javascript:ows.fetch([moduleID,system],-1,'Action=AddPublication','dvPublication');\">Add A New Publication</button>\n<table cellspacing=\"1\" cellpadding=\"1\"  style=\"width:98%;border:0\">\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":160,"Level":0,"Parameters":{"Name":"getPublication","Query":"select p.PublicationID, p.Publication,  p.SeqNo, (select max(SeqNo) from  Ufiler_2AM_Publication Where PortalID = [PortalID,system]) as MaxOrder, (select min(SeqNo) from  Ufiler_2AM_Publication Where portalID = [PortalID,system])  as MinOrder, count(a.PublicationID) as PublicationCount \nfrom Ufiler_2AM_Publication p  left join Ufiler_2AM_Article a on p.PublicationID= a.PublicationID\nWhere p.PortalID = [PortalID,system]\nGroup by p.PublicationID, p.Publication, p.SeqNo \norder by p.SeqNo, p.Publication","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":161,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPublication","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditPublication&ID=[PublicationID,getPublication]','dvPublication');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo,getPublication]'<'[MaxOrder,getPublication]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveStatus&ID=\\[StatusId,getStatus]&Direction=down,'dvStatus'')\\\"><img src='/images/dn.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo,getPublication]'>'[MinOrder,getPublication]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveStatus&ID=\\[PublicationId,getStatus]&Direction=up','dvStatus')\\\"><img src='/images/up.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Publication,getPublication]\n\t{IIF, \"[PublicationCount,getPublication]>0\",\"([PublicationCount,getPublication])\",\"<a href=\\\"javascript:ows.Fetch([ModuleId,system],0,'Action=DelPublication&ID=[PublicationID,getPublication]');\\\" onclick=\\\"return confirm('Are you sure that you want to delete &quot;[Publication,getPublication]&quot;? \\nThis action can not be undone.');\\\"><img src=\\\"/images/delete.gif\\\" alt=\\\"Delete\\\" border=\\\"0\\\" /></a>\"}</td>\n</tr>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":162,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPublication","Value":"</table></div>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":163,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":164,"Level":0,"Parameters":{"Value":"Set up Category display"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":165,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayCategory","Value":"<div id=\"dvCategory\" style=\"float:left;width:32%; border-left:0px solid #000\">\n<h3>Category</h3>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"width:98%;border:0\">\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":166,"Level":0,"Parameters":{"Name":"getCategory","Query":"select c.CategoryID, c.Category, c.SeqNo, count(a.CategoryID) as CategoryCount \nfrom Ufiler_2AM_ArticleCategory c  left join Ufiler_2AM_Article a on c.CategoryID= a.CategoryID\nWhere c.PublicationID= '1'\nGroup by c.CategoryID, c.Category, c.SeqNo \norder by c.SeqNo, c.Category","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":167,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayCategory","Value":"<tr valign=\"top\">\n\t<td class=\"normal\">[Category,getCategory] &nbsp;{IIF, \"[CategoryCount,getCategory]>0\",\"([CategoryCount,getCategory])\",\"\"}</td>\n</tr>\n","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":168,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayCategory","Value":"</table></div>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":169,"Level":0,"Parameters":{"Value":"Set up Person display"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":170,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPerson","Value":"<div id=\"dvPerson\" style=\"float:left;width:32%; border:0px solid #efad1b\">\n<h3>People</h3>\n<table cellspacing=\"1\" cellpadding=\"1\"  style=\"width:98%;border:0\">\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":171,"Level":0,"Parameters":{"Name":"getPerson","Query":"select p.PersonID, p.surname, p.forename, (select count(ownerID) from Ufiler_2AM_Article where OwnerID = p.PersonID) as OwnerCount, (select count(WrittenByID) from Ufiler_2AM_Article where WrittenByID = p.PersonID)as WriterCount\nfrom Ufiler_2AM_Person p  \n\tleft join Ufiler_2AM_Article a on p.PersonID = a.OwnerID \n\tleft join Ufiler_2AM_Article b on p.PersonID = b.WrittenByID\nWhere a.PublicationID= '1'\nGroup by p.PersonID, p.surname, p.forename \norder by p.surname","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":172,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPerson","Value":"<tr valign=\"top\">\n\t<td class=\"normal\" style=\"text-align:left\">[surname,getPerson], [forename,getPerson] ([WriterCount,getPerson])</td>\n</tr>\n","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":173,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayPerson","Value":"</table></div>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":174,"Level":0,"Parameters":{"Value":"Set up Status display"},"ActionType":"Action-Comment","ChildActions":[]},{"Index":175,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayStatus","Value":"<div id=\"dvStatus\" style=\"float:left;width:32%; border-left:0px solid #000\">\n<h3>Status</h3>\n<table cellspacing=\"1\" cellpadding=\"1\"  style=\"width:98%;border:0\">\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":176,"Level":0,"Parameters":{"Name":"getStatus","Query":"select s.statusID, s.status, s.SeqNo, count(a.statusID) as StatusCount \nfrom Ufiler_2AM_ArticleStatus s  left join Ufiler_2AM_Article a on s.statusID= a.StatusID\nWhere s.PublicationID= '1'\nGroup by s.statusID, s.status, s.SeqNo \norder by s.SeqNo, s.status","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":177,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayStatus","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\">[Status,getStatus] ([StatusCount,getStatus])</td>\n</tr>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":178,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"DisplayStatus","Value":"</table></div>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]}]},{"Index":179,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'UpdatePerson'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":180,"Level":0,"Parameters":{"Name":"UpdatePerson","Query":"update Ufiler_2AM_Person\nset Forename = @Forename,\nSurname = @Surname, \nCommissioner = @Commissioner,\nAuthor = @Author,\nReviewer = @Reviewer \nwhere PersonID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":181,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'DeletePerson'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":182,"Level":0,"Parameters":{"Name":"DelPerson","Query":"delete from Ufiler_2AM_Person where PersonID=[@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":183,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'InsertCategory'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":184,"Level":0,"Parameters":{"LeftCondition":"[@CategoryID,variable]","RightCondition":"0","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":185,"Level":0,"Parameters":{"Name":"InsertCategory","Query":"insert into Ufiler_2AM_ArticleCategory(ModuleID,Category,SeqNo)\nvalues([ModuleID,system],[@Category,variable],'1')","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":186,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":187,"Level":0,"Parameters":{"Name":"InsertCategoryAt","Query":"declare @CurPos int\nset @CurPos = (select SeqNo from Ufiler_2AM_ArticleCategory where CategoryID = [@CategoryID,variable])\nIf [@InsertWhere,variable] = 'before' --insert before\n\tbegin\n\t\tUpdate Ufiler_2AM_ArticleCategory set SeqNo = SeqNo + 1 where ModuleID = [ModuleID,system] and SeqNo >= @CurPos\t\n\t\tInsert into Ufiler_2AM_ArticleCategory(ModuleID,Category,SeqNo) Values([ModuleID,system],[@Category,variable],@CurPos)\n\tend\nelse\t\t\t\t-- Insert after\n\tbegin\n\t\tUpdate Ufiler_2AM_ArticleCategory set SeqNo = SeqNo + 1 where ModuleID = [ModuleID,system] and SeqNo > @CurPos\n\t\tInsert into Ufiler_2AM_ArticleCategory(ModuleID,Category,SeqNo) Values([ModuleID,system],[@Category,variable],@CurPos+1)\n\tend\n","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]}]},{"Index":188,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'UpdateCategory'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":189,"Level":0,"Parameters":{"Name":"UpdateCategory","Query":"update Ufiler_2AM_ArticleCategory Set Category= @Category where CategoryID= [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":190,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'MoveCategory'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":191,"Level":0,"Parameters":{"LeftCondition":"[@Direction,variable]","RightCondition":"'up'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":192,"Level":0,"Parameters":{"Name":"MovePriorCategoryDownAndCurrentCategoryUp","Query":"update Ufiler_2AM_ArticleCategory \n\tset SeqNo = SeqNo + 1 \n\twhere SeqNo = (select SeqNo from Ufiler_2AM_ArticleCategory where CategoryID = [@ID,Action]) -1\nupdate Ufiler_2AM_ArticleCategory \n\tset SeqNo = SeqNo - 1 \n\twhere CategoryID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":193,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":194,"Level":0,"Parameters":{"Name":"MoveFollowingCategoryUpAnd CurrentCategoryDown","Query":"update Ufiler_2AM_ArticleCategory \n\tset SeqNo = SeqNo - 1 \n\twhere SeqNo = (select SeqNo from Ufiler_2AM_ArticleCategory where CategoryID = [@ID,Action]) +1\nupdate Ufiler_2AM_ArticleCategory \n\tset SeqNo = SeqNo + 1 \n\twhere CategoryID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]}]},{"Index":195,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'DeleteCategory'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":196,"Level":0,"Parameters":{"Name":"DelCategory","Query":"delete from Ufiler_2AM_ArticleCategory where CategoryID=[@ID,Action]\n-- Close up gaps\ndrop table #Seqno\nCREATE TABLE #Seqno(\n\t[ID] [int] IDENTITY(1,1) NOT NULL,\n\t[oldID] [int] NOT NULL,\n\t[SeqNo] [int] NOT NULL\n)\ninsert into #Seqno (oldID,SeqNo) select c.CategoryID, c.SeqNo from Ufiler_2AM_ArticleCategory c\nwhere ModuleID=[ModuleID,system] order by c.seqno\nselect * from Ufiler_2AM_ArticleCategory\nselect * from #Seqno\nupdate Ufiler_2AM_ArticleCategory set SeqNo = ID\n\tfrom #Seqno s \n\t\tinner join Ufiler_2AM_ArticleCategory c \n\t\t\ton s.[oldID] = c.CategoryID\nselect * from Ufiler_2AM_ArticleCategory","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":197,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'UnpublishArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":198,"Level":0,"Parameters":{"Name":"UnpublishArticleArticle","Query":"update Ufiler_2AM_Article set [Published] = '0' where ArticleID=[@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":199,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'PurgeArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":200,"Level":0,"Parameters":{"Name":"PurgeArticle","Query":"delete from Ufiler_2AM_Article where ArticleID=[@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":201,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'RestoreArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":202,"Level":0,"Parameters":{"Name":"DeleteArticle","Query":"update Ufiler_2AM_Article set [Deleted] = '0' where ArticleID=[@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":203,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'DeleteArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":204,"Level":0,"Parameters":{"Name":"DeleteArticle","Query":"update Ufiler_2AM_Article set [Deleted] = '1' where ArticleID=[@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":205,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'UpdatePublication'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":206,"Level":0,"Parameters":{"Name":"UpdatePublication","Query":"update Ufiler_2AM_Publication Set Publication= @Publication where PublicationID= [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":207,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'MovePublication'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":208,"Level":0,"Parameters":{"LeftCondition":"[@Direction,variable]","RightCondition":"'up'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":209,"Level":0,"Parameters":{"Name":"MovePriorPublicationDownAndCurrentPublicationUp","Query":"update Ufiler_2AM_Publication \n\tset SeqNo = SeqNo + 1 \n\twhere SeqNo = (select SeqNo from Ufiler_2AM_Publication where PublicationID = [@ID,Action]) -1\nupdate Ufiler_2AM_Publication \n\tset SeqNo = SeqNo - 1 \n\twhere PublicationID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":210,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":211,"Level":0,"Parameters":{"Name":"MoveFollowingPublicationUpAnd CurrentPublicationDown","Query":"update Ufiler_2AM_Publication\n\tset SeqNo = SeqNo - 1 \n\twhere SeqNo = (select SeqNo from Ufiler_2AM_Publication where PublicationID = [@ID,Action]) +1\nupdate Ufiler_2AM_Publication\n\tset SeqNo = SeqNo + 1 \n\twhere PublicationID = [@ID,Action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]}]},{"Index":212,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'DeletePublication'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":213,"Level":0,"Parameters":{"Name":"DelPublication","Query":"delete from Ufiler_2AM_Publication where PublicationID=[@ID,Action]\n-- Close up gaps\ndrop table #Seqno\nCREATE TABLE #Seqno(\n\t[ID] [int] IDENTITY(1,1) NOT NULL,\n\t[oldID] [int] NOT NULL,\n\t[SeqNo] [int] NOT NULL\n)\ninsert into #Seqno (oldID,SeqNo) select p.PublicationID, p.SeqNo from Ufiler_2AM_Publication p\nwhere PortalID=[PortalID,system] order by p.seqno\nselect * from Ufiler_2AM_Publication\nselect * from #Seqno\nupdate Ufiler_2AM_Publication set SeqNo = ID\n\tfrom #Seqno s \n\t\tinner join Ufiler_2AM_Publication p \n\t\t\ton s.[oldID] = p.PublicationID\nselect * from Ufiler_2AM_Publication","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]},{"Index":214,"Level":0,"Parameters":{"LeftCondition":"[@ChangeUserRecsPerPage,variable]","RightCondition":"'y'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":215,"Level":0,"Parameters":{"Name":"UpdateUserRecsPerPage","Query":"execute Ufiler_2AM_UpdateUserSetting '[UserID,system]','UserRecsPerPage','[@UserRecsPerPage,variable]'","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":216,"Level":0,"Parameters":{"Type":"&lt;Session&gt;","Name":"@UserRecsPerPage","Value":"[@UserRecsPerPage,variable]","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":217,"Level":0,"Parameters":{"Value":"Place Comment Here"},"ActionType":"Action-Comment","ChildActions":[{"Index":218,"Level":0,"Parameters":{"Name":"UpdateUserRecsPerPage","Query":"-- Try the UserID/SettingValue to see if a value exists\nDECLARE @RecsPerPageSetting\nSELECT @RecsPerPageSetting = SettingValue\n\tFROM   Ufiler_2AM_UserSettings\n\tWHERE  UserID = '[UserID,system]' AND SettingName = 'RecsPerPage'\n \nIF @RecsPerPageSetting IS NOT NULL\n\t-- Update Record\n\tBEGIN\n\t\tUPDATE dbo.Ufiler_2AM_UserSettings\n\t\t\tSET SettingValue = '[@UserRecsPerPage,variable]'\n\t\t\tWHERE  UserID = '[UserID,system]' AND SettingName = 'RecsPerPage'\n\tEND\nELSE \n\t-- Insert New Record\n\tBEGIN\n\t\tINSERT INTO dbo.Ufiler_2AM_UserSettings (UserID, SettingName, SettingValue)\n\t\tVALUES (\n\t\t\t'[UserID,system]','RecsPerPage','[@UserRecsPerPage,variable]')\nEND\n","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]}]}]}]},{"Index":219,"Level":0,"Parameters":{"Name":"OnRender","RenderType":"0","skipDebug":"False","includeSearch":"False","includeExport":"False","includeImport":"False"},"ActionType":"Action-Region","ChildActions":[{"Index":220,"Level":0,"Parameters":{"LeftCondition":"[format,\"[@UserRecsPerPage,session]\",{length}]","RightCondition":"0","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":221,"Level":0,"Parameters":{"Name":"getUserRecsPerPage","Query":"select SettingValue as 'SettingValue' from Ufiler_2AM_UserSettings where SettingName='UserRecsPerPage' and UserID='[UserID,system]'","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":222,"Level":0,"Parameters":{"LeftCondition":"'[coalesce,SettingValue,getUserRecsPerPage,{length}]'","RightCondition":"''","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":223,"Level":0,"Parameters":{"Type":"&lt;Session&gt;","Name":"@UserRecsPerPage","Value":"0","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":224,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":225,"Level":0,"Parameters":{"Type":"&lt;Session&gt;","Name":"@UserRecsPerPage","Value":"[SettingValue,getUserRecsPerPage]","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":226,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"ResLength","Value":"[format,\"[SettingValue,getUserRecsPerPage]\",{length}]","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":227,"Level":0,"Parameters":{"Value":"Place Comment Here"},"ActionType":"Action-Comment","ChildActions":[]}]},{"Index":228,"Level":0,"Parameters":{"Name":"Set up Tabs - This is always going to be invoked","RenderType":"0","skipDebug":"false","includeSearch":"false","includeExport":"false","includeImport":"false"},"ActionType":"Action-Region","ChildActions":[{"Index":229,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Buttons","Value":"<div>\n<ul class=\"Ufiler-tabs\">\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'');\" {IIF, \"[@Action,variable]=NULL or [@Action,variable]='ShowActive'\", \"class='current'\", \"class='notcurrent'\"}>Active</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowRel');\" {IIF, \"[@Action,variable]='ShowRel'\", \"class='current'\", \"class='notcurrent'\"}>Released</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowPub');\" {IIF, \"[@Action,variable]='ShowPub'\", \"class='current'\", \"class='notcurrent'\"}>Published</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowDel');\" {IIF, \"[@Action,variable]='ShowDel'\", \"class='current'\", \"class='notcurrent'\"}>Deleted</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=Search');\" {IIF, \"[@Action,variable]='Search'\", \"class='current'\", \"class='notcurrent'\"}>Search</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowSchedule');\" {IIF, \"[@Action,variable]='ShowSchedule'\", \"class='current'\", \"class='notcurrent'\"}>Schedule</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowAsset');\" {IIF, \"[@Action,variable]='ShowAsset'\", \"class='current'\", \"class='notcurrent'\"}>Assets</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowStats');\" {IIF, \"[@Action,variable]='ShowStats'\", \"class='current'\", \"class='notcurrent'\"}>{IIF, \"'[CanAdminister,Action]'='True'\", \"Admin\", \"Statistics\"}</a></li>\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":230,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":231,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Buttons","Value":"<!--<li><a href='#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=Profile');\" {IIF, \"[@Action,variable]='Profile'\", \"class='current'\", \"class='notcurrent'\"}>Profile</a></li>-->\n<li><a href='#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddArticle');\" {IIF, \"[@Action,variable]='AddArticle'\", \"class='current'\", \"class='notcurrent'\"}>Add Article</a></li>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":232,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Buttons","Value":"</ul>\n</div>\n<div class=\"Ufiler-panes\">\n\t<div class=\"Ufiler-content\">\n","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":233,"Level":0,"Parameters":{"Value":"Place Comment Here"},"ActionType":"Action-Comment","ChildActions":[{"Index":234,"Level":0,"Parameters":{"Name":"Set up Tabs - This is always going to be invoked","RenderType":"0","skipDebug":"false","includeSearch":"false","includeExport":"false","includeImport":"false"},"ActionType":"Action-Region","ChildActions":[{"Index":235,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Buttons","Value":"<div>\n<ul class=\"Ufiler-tabs\">\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowTables');\" {IIF, \"[@Action,variable]=NULL or [@Action,variable]='ShowTables'\", \"class='current'\", \"class='notcurrent'\"}>Tables</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowFixtures');\" {IIF, \"[@Action,variable]='ShowFixtures'\", \"class='current'\", \"class='notcurrent'\"}>Fixtures</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowTeams');\" {IIF, \"[@Action,variable]='ShowTeams'\", \"class='current'\", \"class='notcurrent'\"}>Teams</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowVenues');\" {IIF, \"[@Action,variable]='ShowVenues'\", \"class='current'\", \"class='notcurrent'\"}>Venues</a></li>\n<!--<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=Search');\" {IIF, \"[@Action,variable]='Search'\", \"class='current'\", \"class='notcurrent'\"}>Search</a></li>\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowSchedule');\" {IIF, \"[@Action,variable]='ShowSchedule'\", \"class='current'\", \"class='notcurrent'\"}>Schedule</a></li>-->\n<li><a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowStats');\" {IIF, \"[@Action,variable]='ShowStats'\", \"class='current'\", \"class='notcurrent'\"}>{IIF, \"'[CanAdminister,Action]'='True'\", \"Admin\", \"Statistics\"}</a></li>\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":236,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":237,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Buttons","Value":"<!--<li><a href='#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=Profile');\" {IIF, \"[@Action,variable]='Profile'\", \"class='current'\", \"class='notcurrent'\"}>Profile</a></li>-->\n<li><a href='#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddVenue');\" {IIF, \"[@Action,variable]='AddVenue'\", \"class='current'\", \"class='notcurrent'\"}>Add Venue</a></li>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":238,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Buttons","Value":"</ul>\n</div>\n<div class=\"Ufiler-panes\">\n\t<div class=\"Ufiler-content\">\n","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":239,"Level":0,"Parameters":{"Type":"CONTROL.HEADER","Name":"","Value":"<script src=\"/js/tooltipmain.js\" type=\"text/javascript\"> </script>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":240,"Level":0,"Parameters":{"Type":"CONTROL.FOOTER","Name":"","Value":"$(document).ready(function() {\n    $(\".ttip\").hover(function() {\n        if ($(\".hover\", this).css(\"display\") == \"block\") { return false; }\n        os = $(this).offset();\n        $(\".ttiptext\", this).css({top: os.top+\"px\", left: os.left+60+\"px\"}).animate({top: os.top-60+\"px\", opacity: \"show\"}, 750);\n    },\n    function() {\n        os = $(this).offset();\n        $(\".hover\", this).animate({top: os.top+\"px\", opacity: \"hide\"}, 500);\n    });\n});","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":241,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = NULL or [@Action,variable] = 'UpdateArticle' or [@Action,variable] = 'InsertArticle' or [@Action,variable] = 'ShowActive' or [@Action,variable] = 'Profile' or [@Action,variable] = 'ReleaseArticle' or [@Action,variable] = 'RecallArticle'","RightCondition":"NULL","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-If","ChildActions":[{"Index":242,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n\t\t<h2>Active Articles</h2>\n\t\t<p>No Articles found</p>\n\t</div>\n</div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":243,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"[@SQLHeader,action]\n\nSelect a.articleID\n, a.[Subject], c.Category, a.categoryID, c.SeqNo as 'CategoryOrder', s.[Status], s.Releasable, s.SeqNo as 'StatusOrder', cb.initials as 'Owner', wb.initials as 'WrittenBy'\n, d1.shortMonthName+'-'+d1.shortYear as 'Scheduled', count(aad.articleID) as AssetCount, notes, len(notes) as noteslen,ROW_NUMBER() \nOVER (ORDER BY {IIF, \"'[SORTTAG]'='Released ASC' or '[SORTTAG]'='Released DESC' or '[SORTTAG]'='Published ASC' or '[SORTTAG]'='Published DESC' or '[SORTTAG]'='1'  \", \"a.ArticleID ASC\", \"[SORTTAG]\"}) as RowNumber\nfrom Ufiler_2AM_Article a\n\tleft join Ufiler_2AM_ArticleCategory c on a.CategoryID = c.CategoryID\n\tleft join Ufiler_2AM_ArticleStatus s on a.StatusID = s.statusID\n\tleft join Ufiler_2AM_Person cb on a.ownerID = cb.PersonID\n\tleft join Ufiler_2AM_Person wb on a.writtenbyID = wb.PersonID\n\tleft join Ufiler_DateLookup d1 on a.scheduledfor = d1.datekey\n\tleft join Ufiler_2AM_ArticleAssetData aad on a.ArticleID = aad.articleid\nwhere a.PublicationID = '1' and a.Deleted <> '1' and a.Released IS NULL and (a.published ='0' or a.published IS NULL) and @Category_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter and @Status_Filter\ngroup by a.PublicationID, a.articleID, a.[Subject],c.Category,a.categoryID, c.SeqNo, s.[Status], s.Releasable, s.SeqNo, cb.initials, wb.initials, d1.shortMonthName+'-'+d1.shortYear, a.scheduledfor, notes\n\n[@SQLPagerSelects,action]\nfrom Ufiler_2AM_Article a where a.Deleted <> '1' and a.Released IS NULL and (a.published ='0' or a.published IS NULL) and @Category_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter and @Status_Filter","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":244,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Header","Value":"<h2 style=\"float:left;margin:-5px 30px 0 0\">Active Articles</h2>\n[@Pager,Action]\n[@RecsPerPage,Action]\n<hr style=\"clear:both\" />\n<div id=\"SResult\">","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":245,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":246,"Level":0,"Parameters":{"LeftCondition":"'[2AM_FiltersInline,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":247,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n[@Header,Action]\n<table cellpadding=\"3\" style=\"width:100%;border:0;clear:both\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td colspan=\"3\">&nbsp;</td>\t\n\t<td style=\"text-align:left\"><a {SORT,Subject,\"Subject\",\"Subject <img src='/images/up.gif' style='border:0' />\", \"Subject <img src='/images/dn.gif' style='border:0' />\",,1,}>{sortheader,1}</a></td>\n\t<td style=\"text-align:left\"><a {SORT,Category,\"Category\",\"Category <img src='/images/up.gif' style='border:0' />\", \"Category <img src='/images/dn.gif' style='border:0' />\",,6,}>{sortheader,6}</a></td>\n\t<td style=\"text-align:left\"><a {SORT,StatusOrder,\"Status\",\"Status <img src='/images/up.gif' style='border:0' />\", \"Status <img src='/images/dn.gif' style='border:0' />\",,5,}>{sortheader,5}</a></td>\n\t<td style=\"text-align:left\"><a {SORT,OwnerID,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,4,}>{sortheader,4}</a></td>\n\t<td style=\"text-align:left\"><a {SORT,WrittenBy,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,3,}>{sortheader,3}</a></td>\n\t<td style=\"text-align:left\"><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,2,}>{sortheader,2}</a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":248,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditArticle&ID=[ArticleID]');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"'[Releasable]'='True'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[ModuleId,system],0,'Action=ReleaseArticle&ID=\\[ArticleID]');\\\"><img src=\\\"/images/rt.gif\\\" alt=\\\"ReleaseArticle\\\" border=\\\"0\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.fetch([moduleid,system]',0,'cat=[categoryID]');\">[Category]</a></td>\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeleteArticle&ID=[ArticleID]');\"><img src=\"/images/delete.gif\" alt=\"Delete\" border=\"0\" /></a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":249,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":250,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n[@Header,Action]\n<table cellpadding=\"3\" style=\"width:100%;border:0;clear:both\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td colspan=\"3\">&nbsp;</td>\n\t<td style=\"text-align:left\"><a {SORT,Subject,\"Subject\",\"Subject <img src='/images/up.gif' style='border:0' />\", \"Subject <img src='/images/dn.gif' style='border:0' />\",,1,}>{sortheader,1}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCategories\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory order by SeqNo\" , Header=\"<select id='fltCategory' name='fltCategory' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[CategoryID]'>\\[Category]</option>\", SelectedFormat=\"<option value='\\[CategoryID]' selected='selected'>\\[Category]</option>\", SelectedField=\"CategoryID\", SelectedItems=\"[fltCategory,form]\", UseCache=False}<br /><a {SORT,Category,\"Category\",\"Category <img src='/images/up.gif' style='border:0' />\", \"Category <img src='/images/dn.gif' style='border:0' />\",,6,}>{sortheader,6}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getArticleStatus\", Query=\"select StatusID, Status from Ufiler_2AM_ArticleStatus order by SeqNo\" , Header=\"<select id='fltStatus' name='fltStatus' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[StatusID]'>\\[Status]</option>\", SelectedFormat=\"<option value='\\[StatusID]' selected='selected'>\\[Status]</option>\", SelectedField=\"StatusID\", SelectedItems=\"[fltStatus,form]\", UseCache=False}<br /><a {SORT,s.seqno,\"Status\",\"Status <img src='/images/up.gif' style='border:0' />\", \"Status <img src='/images/dn.gif' style='border:0' />\",,5,}>{sortheader,5}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='fltOwnerID' name='fltOwner' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltOwner,form]\", UseCache=False}<br /><a {SORT,cb.initials,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,4,}>{sortheader,4}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='fltWrittenBy' name='fltWrittenBy' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltWrittenBy,form]\", UseCache=False}<br /><a {SORT,wb.initials,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,3,}>{sortheader,3}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='fltScheduledFor' name='fltScheduledFor' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltScheduledFor,form]\", UseCache=False}<br /><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,2,}>{sortheader,2}</a></td>\n\t<td>&nbsp;</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":251,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditArticle&ID=[ArticleID]');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"'[Releasable]'='True'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[ModuleId,system],0,'Action=ReleaseArticle&ID=\\[ArticleID]');\\\"><img src=\\\"/images/rt.gif\\\" alt=\\\"ReleaseArticle\\\" border=\\\"0\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]{IIF, \"[assetcount]>0\", \"&AssetCount=[AssetCount])\", \"\"}');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeleteArticle&ID=[ArticleID]');\"><img src=\"/images/delete.gif\" alt=\"Delete\" border=\"0\" /></a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]}]},{"Index":252,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":253,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n[@Header,Action]\n<table cellpadding=\"3\" style=\"width:100%;border:0;clear:both\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td style=\"text-align:left\"><a {SORT,Subject,\"Subject\",\"Subject <img src='/images/up.gif' style='border:0' />\", \"Subject <img src='/images/dn.gif' style='border:0' />\",,1,}>{sortheader,1}</a></td>\n\t<td></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCategories\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory order by SeqNo\" , Header=\"<select id='fltCategory' name='fltCategory' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[CategoryID]'>\\[Category]</option>\", SelectedFormat=\"<option value='\\[CategoryID]' selected='selected'>\\[Category]</option>\", SelectedField=\"CategoryID\", SelectedItems=\"[fltCategory,form]\", UseCache=False}<br /><a {SORT,CategoryOrder,\"Category\",\"Category <img src='/images/up.gif' style='border:0' />\", \"Status <img src='/images/dn.gif' style='border:0' />\",,6,}>{sortheader,6}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getArticleStatus\", Query=\"select StatusID, Status from Ufiler_2AM_ArticleStatus order by SeqNo\" , Header=\"<select id='fltStatus' name='fltStatus' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[StatusID]'>\\[Status]</option>\", SelectedFormat=\"<option value='\\[StatusID]' selected='selected'>\\[Status]</option>\", SelectedField=\"StatusID\", SelectedItems=\"[fltStatus,form]\", UseCache=False}<br /><a {SORT,StatusOrder,\"Status\",\"Status <img src='/images/up.gif' style='border:0' />\", \"Status <img src='/images/dn.gif' style='border:0' />\",,5,}>{sortheader,5}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='fltOwnerID' name='fltOwner' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltOwner,form]\", UseCache=False}<br /><a {SORT,OwnerID,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,4,}>{sortheader,4}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='fltWrittenBy' name='fltWrittenBy' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltWrittenBy,form]\", UseCache=False}<br /><a {SORT,WrittenBy,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,3,}>{sortheader,3}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='fltScheduledFor' name='fltScheduledFor' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltScheduledFor,form]\", UseCache=False}<br /><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,2,}>{sortheader,2}</a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":254,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":255,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"[@Footer,action]</div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":256,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'DoSearch' and [FORMAT,fltSubject,form,{length}]>2","RightCondition":"","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":257,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<p>No articles found</p>\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":258,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"[@SQLHeader,action]\nSelect a.articleID\n, a.[Subject], c.Category, c.SeqNo as 'CategoryOrder', s.[Status], s.Releasable, s.SeqNo as 'StatusOrder', cb.initials as 'Owner', wb.initials as 'WrittenBy'\n, d1.shortMonthName+'-'+d1.shortYear as 'Scheduled', count(aad.articleID) as AssetCount, notes, len(notes) as noteslen ,ROW_NUMBER() \nOVER (ORDER BY {IIF, \"'[SORTTAG]'='Released ASC' or '[SORTTAG]'='Released DESC' or '[SORTTAG]'='Published ASC' or '[SORTTAG]'='Published DESC' or '[SORTTAG]'='1'  \", \"a.ArticleID ASC\", \"[SORTTAG]\"}) as RowNumber\nfrom Ufiler_2AM_Article a\n\tleft join Ufiler_2AM_ArticleCategory c on a.CategoryID = c.CategoryID\n\tleft join Ufiler_2AM_ArticleStatus s on a.StatusID = s.statusID\n\tleft join Ufiler_2AM_Person cb on a.ownerID = cb.PersonID\n\tleft join Ufiler_2AM_Person wb on a.writtenbyID = wb.PersonID\n\tleft join Ufiler_DateLookup d1 on a.scheduledfor = d1.datekey\n\tleft join Ufiler_2AM_ArticleAssetData aad on a.ArticleID = aad.articleid\nwhere a.PublicationID= '1' and @fltSubject\ngroup by a.PublicationID, a.articleID, a.[Subject],c.Category,c.SeqNo, s.[Status], s.Releasable, s.SeqNo, cb.initials, wb.initials, d1.shortMonthName+'-'+d1.shortYear, a.scheduledfor, notes\n[@SQLPagerSelects,action]\nfrom Ufiler_2AM_Article a where a.PublicationID= '1' and a.Deleted <> '1' and @Category_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter and @Status_Filter","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":259,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":260,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<table cellspacing=\"3\" cellpadding=\"3\" style=\"width:98%;border:0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td>Edit</td><td style=\"text-align:center\">Release</td>\t\n\t<td style=\"text-align:left\">Subject</td>\n\t<td>Assets</td>\n\t<td style=\"text-align:left\">Category</td>\n\t<td style=\"text-align:left\">Status</td>\n\t<td style=\"text-align:left\">Owner</td>\n\t<td style=\"text-align:left\">Written&nbsp;By</td>\n\t<td style=\"text-align:left\">Scheduled For</td>\n\t<td>Del</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":261,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditArticle&ID=[ArticleID]');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"'[Releasable]'='True'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[ModuleId,system],0,'Action=ReleaseArticle&ID=\\[ArticleID]');\\\"><img src=\\\"/images/rt.gif\\\" alt=\\\"ReleaseArticle\\\" border=\\\"0\\\" /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeleteArticle&ID=[ArticleID]');\"><img src=\"/images/delete.gif\" alt=\"Delete\" border=\"0\" /></a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":262,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":263,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":264,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<table cellspacing=\"3\" cellpadding=\"3\" style=\"width:98%;border:0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td style=\"text-align:left\">Subject</td>\n\t<td>Assets</td>\n\t<td style=\"text-align:left\">Category</td>\n\t<td style=\"text-align:left\">Status</td>\n\t<td style=\"text-align:left\">Owner</td>\n\t<td style=\"text-align:left\">Written&nbsp;By</td>\n\t<td style=\"text-align:left\">Scheduled&nbsp;For</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":265,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":266,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]}]},{"Index":267,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'Search'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":268,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n<h2>Search Article Titles</h2>\n<input name=\"fltSubject\" onkeyup=\"ows.Fetch([ModuleID,system],0,'Action=DoSearch','SResult');\" placeholder=\"start typing here\" />\n<div id=\"SResult\"></div>\n</div></div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":269,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'ShowArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":270,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select a.articleID\n, a.[Subject], c.Category, s.[Status], cb.initials as 'Owner', wb.initials as 'WrittenBy'\n, d1.shortMonthName+'-'+d1.shortYear as 'Scheduled', count(aad.articleid) as 'assetcount', notes, len(notes) as noteslen\nfrom Ufiler_2AM_Article a\n\tleft join Ufiler_2AM_ArticleCategory c on a.CategoryID = c.CategoryID\n\tleft join Ufiler_2AM_ArticleStatus s on a.StatusID = s.statusID\n\tleft join Ufiler_2AM_Person cb on a.ownerID = cb.PersonID\n\tleft join Ufiler_2AM_Person wb on a.writtenbyID = wb.PersonID\n\tleft join Ufiler_DateLookup d1 on a.scheduledfor = d1.datekey\n\tleft join Ufiler_2AM_ArticleAssetData aad on a.ArticleID = aad.articleid\nwhere a.ArticleId= [@ID,Action]\ngroup by a.articleID, a.[Subject], c.Category, s.[Status], cb.initials, wb.initials, d1.shortMonthName+'-'+d1.shortYear, notes, len(notes)","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":271,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"[@Buttons,Action]\n<h1>Article Details</h1>\n<table width=\"100%\" cellspacing=\"3\" cellpadding=\"3\" border=\"0\">\n\t<tr valign=\"top\"><td class=\"formlabel\">Subject:</td><td>[Subject]</td><td align=\"left\" valign=\"bottom\"><strong>Notes:</strong></td></tr>\n\t<tr><td class=\"formlabel\">Category:</td><td>[Category]</td><td rowspan=\"5\" valign=\"top\" align=\"left\">[Notes]</td></tr>\n\t<tr><td class=\"formlabel\">Status:</td><td>[Status]</td></tr>\n\t<tr><td class=\"formlabel\">Commissioned By:</td><td>[Owner]</td></tr>\n\t<tr><td class=\"formlabel\">Written By:</td><td>[WrittenBy]</td></tr>\n\t<tr><td class=\"formlabel\">Scheduled For:</td><td>[Scheduled]</td></tr>\n\t{SUBQUERY, Name=\"GetAssets\", Query=\"select * from Ufiler_2AM_ArticleAssetData where articleID = [@ID,Action]\" , Header=\"<tr><td colspan=\\\"3\\\">\", Footer=\"</td></tr>\", NoResultFormat=\"<p>This article has no Assets</p>\", NoQueryFormat=\"\", Format=\"<div style=\\\"float:left;margin:right:7px;\\\"><a href=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/Thumbnails/\\[AssetName\\].thumb.jpg\\\" alt=\\\"\\\" /></a><br />\\[AssetName\\]<br />\\[AssetDescription\\]<br />\\[AssetCredit\\] </div>\", UseCache=\"False\"}\t\n\t<tr>\n\t\t<td colspan=\"3\" align=\"center\"><hr />\n\t<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'');\">Cancel</button>\n\t\t</td>\n\t</tr>\n</table></div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":272,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'AddArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":273,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n<h1>Add Article</h1>\n<table width=\"100%\" cellspacing=\"3\" cellpadding=\"3\" border=\"0\">\n\t<tr valign=\"top\"><td class=\"formlabel\">Subject:</td><td><input name=\"frmSubject\" id=\"frmSubject\" type=\"text\" size=\"50\" maxlength=\"100\" /></td><td align=\"left\" valign=\"bottom\"><strong>Notes:</strong></td></tr>\n\t<tr><td class=\"formlabel\">Category:</td><td>{SUBQUERY, Name=\"getArticleCategory\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory order by SeqNo\" , Header=\"<select id='frmArticleCategory' name='frmArticleCategory' size='1'>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='[CategoryID]'>[Category]</option>\", SelectedFormat=\"<option value='[CategoryID]' selected='selected''>[Category]</option>\"}</td><td rowspan=\"5\" valign=\"top\" align=\"left\"><textarea style=\"width:400px;\" cols=\"40\" rows=\"9\" id=\"frmNotes\" name=\"frmNotes\"></textarea></td></tr>\n\t<tr><td class=\"formlabel\">Status:</td><td>{SUBQUERY, Name=\"getArticleStatus\", Query=\"select StatusID, Status from Ufiler_2AM_ArticleStatus order by SeqNo\" , Header=\"<select id='frmArticleStatusID' name='frmArticleStatusID' size='1'>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='[StatusID]'>[Status]</option>\", SelectedFormat=\"<option value='[StatusID]' selected='selected''>[Status]</option>\"}</td></tr>\n\t<tr><td class=\"formlabel\">Commissioned By:</td><td>{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='frmOwnerID' name='frmOwnerID' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='[PersonID]'>[Surname], [Forename]</option>\", SelectedFormat=\"<option value='[PersonID]' selected='selected''>[Surname], [Forename]</option>\"}</td></tr>\n\t<tr><td class=\"formlabel\">Written By</td><td>{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='frmWrittenByID' name='frmWrittenByID' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='[PersonID]'>[Surname], [Forename]</option>\", SelectedFormat=\"<option value='[PersonID]' selected='selected''>[Surname], [Forename]</option>\"}</td></tr>\n\t<tr><td class=\"formlabel\">Scheduled For:</td><td>{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-2,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='frmScheduledFor' name='frmScheduledFor' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='[datekey]'>[schedmonth]</option>\", SelectedFormat=\"<option value='[DateKey]' selected='selected'>[ScheduledFor]</option>\"}</td></tr>\n\t<tr>\n\t\t<td colspan=\"3\" align=\"center\"><hr />\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=InsertArticle');\">Add Article</button> \n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddArticle');\">Reset</button> \n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowActive');\">Cancel</button>\n\t\t</td>\n\t</tr>\n</table></div></div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":274,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'EditArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":275,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select a.articleID\n, a.Subject, a.StatusID, a.OwnerID, a.WrittenByID\n, a.ScheduledFor\n, a.notes\n, a.CategoryID\nfrom Ufiler_2AM_Article a\nwhere ArticleId= [@ID,Action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":276,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"[@Buttons,Action]\n<h1>Edit Active Article</h1>\n<table width=\"100%\" cellspacing=\"3\" cellpadding=\"3\" border=\"0\">\n\t<tr valign=\"top\"><td class=\"formlabel\">Subject:</td><td><input name=\"frmSubject\" id=\"frmSubject\" type=\"text\" size=\"50\" maxlength=\"100\" value=\"[Subject]\" /></td><td align=\"left\" valign=\"bottom\"><strong>Notes:</strong></td></tr>\n\t<tr><td class=\"formlabel\">Category:</td><td>{SUBQUERY, Name=\"getArticleCategory\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory order by SeqNo\" , Header=\"<select id='frmArticleCategory' name='frmArticleCategory' size='1'>\", Footer=\"</select>\", Format=\"<option value='\\[CategoryID]'>\\[Category]</option>\", SelectedFormat=\"<option value='\\[CategoryID]' selected='selected'>\\[Category]</option>\", SelectedField=\"CategoryID\", SelectedItems=\"[CategoryID]\", UseCache=False}</td><td rowspan=\"5\" valign=\"top\" align=\"left\"><textarea style=\"width:400px;\" cols=\"40\" rows=\"9\" id=\"frmNotes\" name=\"frmNotes\">[Notes]</textarea></td></tr>\n\t<tr><td class=\"formlabel\">Status:</td><td>{SUBQUERY, Name=\"getArticleStatus\", Query=\"select StatusID, Status from Ufiler_2AM_ArticleStatus order by SeqNo\" , Header=\"<select id='frmArticleStatusID' name='frmArticleStatusID' size='1'>\", Footer=\"</select>\", Format=\"<option value='\\[StatusID]'>\\[Status]</option>\", SelectedFormat=\"<option value='\\[StatusID]' selected='selected'>\\[Status]</option>\", SelectedField=\"StatusID\", SelectedItems=\"[StatusID]\", UseCache=False}</td></tr>\n\t<tr><td class=\"formlabel\">Commissioned By:</td><td>{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='frmOwnerID' name='frmOwnerID' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[OwnerID]\", UseCache=False}</td></tr>\n\t<tr><td class=\"formlabel\">Written By</td><td>{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='frmWrittenByID' name='frmWrittenByID' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[WrittenByID]\", UseCache=False}</td></tr>\n\t<tr><td class=\"formlabel\">Scheduled For:</td><td>{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='frmScheduledFor' name='frmScheduledFor' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[ScheduledFor]\", UseCache=False}</td></tr>\n\t<tr>\n\t\t<td colspan=\"3\" align=\"center\"><hr />\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=UpdateArticle&ID=[ArticleID]');\">Save</button> \n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=EditArticle&ID=[ArticleID]');\">Reset</button> \n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'');\">Cancel</button>\n\t\t</td>\n\t</tr>\n</table></div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":277,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'EditReleasedArticle'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":278,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select a.articleID\n, a.Subject, a.WrittenByID\n, a.scheduledfor\n, a.Published\n, a.pages\n, a.publishedtitle\nfrom Ufiler_2AM_Article a\nwhere ArticleId= [@ID,Action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":279,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"[@Buttons,Action]\n<h1>Edit published details for [Subject]</h1>\n<table width=\"100%\" cellspacing=\"3\" cellpadding=\"3\" border=\"0\">\n\t<tr><td class=\"formlabel\">Scheduled For:</td><td>{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='frmScheduledFor' name='frmScheduledFor' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[ScheduledFor]\", UseCache=False}</td></tr>\n\t<tr><td class=\"formlabel\">Pages:</td><td><input name=\"frmPages\" id=\"frmPages\" type=\"text\" size=\"6\" maxlength=\"6\" value=\"[pages]\"/></td></tr>\n\t<tr><td class=\"formlabel\">Published:</td><td>{SUBQUERY, Name=\"getPublished\", Query=\"select datekey, shortMonthName + '-' + ShortYear as PubMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,1,getdate()),112) order by datekey\" , Header=\"<select id='frmPublished' name='frmPublished' size='1'><option value='0'>tba</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[datekey]'>\\[pubmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[PubMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[Published]\", UseCache=False}</td></tr>\n\t<tr><td class=\"formlabel\">Published Title:</td><td><input name=\"frmPublishedTitle\" id=\"frmPublishedTitle\" type=\"text\" size=\"25\" maxlength=\"50\" value=\"[PublishedTitle]\"/></td></tr>\n\t<tr>\n\t\t<td colspan=\"3\" align=\"center\"><hr />\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=UpdateReleasedArticle&ID=[ArticleID]');\">Save</button> \n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=EditReleasedArticle&ID=[ArticleID]');\">Reset</button> \n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowRel');\">Cancel</button>\n\t\t</td>\n\t</tr>\n</table></div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":280,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowDel' or [@Action,variable] = 'PurgeArticle'","RightCondition":"'ShowDel'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":281,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Header","Value":"<h2 style=\"float:left;margin:-5px 30px 0 0\">Deleted Articles</h2>\n[@Pager,Action]\n[@RecsPerPage,Action]\n<hr style=\"clear:both\" />","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":282,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n\t\t<h2>Deleted Articles</h2>\n\t\t<p>No deleted articles found</p>\n\t</div>\n</div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":283,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"[@SQLHeader,action]\n\nSelect a.articleID, a.[Subject], s.[Status], cb.initials as 'Owner'\n\t, wb.initials as 'WrittenBy', d1.shortMonthName+'-'+d1.shortYear as 'Scheduled', notes, len(notes) as noteslen,ROW_NUMBER() \nOVER ( ORDER BY {IIF, \"'[SORTTAG]'='Released ASC' or '[SORTTAG]'='Released DESC' or '[SORTTAG]'='Published ASC' or '[SORTTAG]'='Published DESC' or '[SORTTAG]'='1'  \", \"a.ArticleID ASC\", \"[SORTTAG]\"}) as RowNumber\nfrom Ufiler_2AM_Article a\n\tleft join Ufiler_2AM_ArticleStatus s on a.StatusID = s.statusID\n\tleft join Ufiler_2AM_Person cb on a.ownerID = cb.PersonID\n\tleft join Ufiler_2AM_Person wb on a.writtenbyID = wb.PersonID\n\tleft join Ufiler_DateLookup d1 on a.scheduledfor = d1.datekey\nwhere a.PublicationID= '1' and Deleted = '1' and @Status_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter\n\n[@SQLPagerSelects,action]\nfrom Ufiler_2AM_Article a where a.PublicationID= '1' and a.Deleted = '1' and @Status_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter\n","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":284,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":285,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n[@Header,Action]\n<table cellpadding=\"3\" style=\"width:100%;border:0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td class=\"iconcol\">Restore Article</td>\n\t<td style=\"text-align:left\"><a {SORT,Subject,\"Subject\",\"Subject&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Subject&nbsp;<img src='/images/dn.gif' style='border:0' />\",,65,Action=ShowDel}>{sortheader,65}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getArticleStatus\", Query=\"select StatusID, Status from Ufiler_2AM_ArticleStatus order by SeqNo\" , Header=\"<select id='fltStatus' name='fltStatus' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[StatusID]'>\\[Status]</option>\", SelectedFormat=\"<option value='\\[StatusID]' selected='selected'>\\[Status]</option>\", SelectedField=\"StatusID\", SelectedItems=\"[fltStatus,form]\", UseCache=False}<br /><a {SORT,StatusOrder,\"Status\",\"Status <img src='/images/up.gif' style='border:0' />\", \"Status <img src='/images/dn.gif' style='border:0' />\",,67,Action=ShowDel}>{sortheader,67}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='fltOwnerID' name='fltOwner' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltOwner,form]\", UseCache=False}<br /><a {SORT,cb.initials,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,64,Action=ShowDel}>{sortheader,64}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='fltWrittenBy' name='fltWrittenBy' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltWrittenBy,form]\", UseCache=False}<br /><a {SORT,wb.initials,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,63,Action=ShowDel}>{sortheader,63}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='fltScheduledFor' name='fltScheduledFor' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltScheduledFor,form]\", UseCache=False}<br /><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,62,Action=ShowDel}>{sortheader,62}</a></td>\n\t<td>Purge</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":286,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=RestoreArticle&ID=[ArticleID]');\"><img src=\"/images/lt.gif\" alt=\"RestoreArticle\" border=\"0\" /></a></td>\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n\t<td class=\"iconcol\"><a href=\"javascript:ows.Fetch([ModuleId,system],0,'Action=PurgeArticle&ID=[ArticleID]');\" onclick=\"return confirm('Are you sure that you want to purge &quot;[Subject]&quot; from the system? nThis action can not be undone.');\"><img src=\"/images/delete.gif\" alt=\"Purge\" border=\"0\" /></a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":287,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"[@Footer,action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":288,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":289,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n[@Header,Action]\n<table cellpadding=\"3\" style=\"width:100%;border:0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td style=\"text-align:left\"><a {SORT,Subject,\"Subject\",\"Subject&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Subject&nbsp;<img src='/images/dn.gif' style='border:0' />\",,65,Action=ShowDel}>{sortheader,65}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getArticleStatus\", Query=\"select StatusID, Status from Ufiler_2AM_ArticleStatus order by SeqNo\" , Header=\"<select id='fltStatus' name='fltStatus' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[StatusID]'>\\[Status]</option>\", SelectedFormat=\"<option value='\\[StatusID]' selected='selected'>\\[Status]</option>\", SelectedField=\"StatusID\", SelectedItems=\"[fltStatus,form]\", UseCache=False}<br /><a {SORT,StatusOrder,\"Status\",\"Status <img src='/images/up.gif' style='border:0' />\", \"Status <img src='/images/dn.gif' style='border:0' />\",,67,Action=ShowDel}>{sortheader,67}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='fltOwnerID' name='fltOwner' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltOwner,form]\", UseCache=False}<br /><a {SORT,cb.initials,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,64,Action=ShowDel}>{sortheader,64}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='fltWrittenBy' name='fltWrittenBy' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltWrittenBy,form]\", UseCache=False}<br /><a {SORT,wb.initials,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,63,Action=ShowDel}>{sortheader,63}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='fltScheduledFor' name='fltScheduledFor' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowDel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltScheduledFor,form]\", UseCache=False}<br /><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,62,Action=ShowDel}>{sortheader,62}</a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":290,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":291,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"[@Footer,action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]}]},{"Index":292,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowPub' or [@Action,variable] = 'UpdateReleasedArticle'","RightCondition":"'ShowPub'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":293,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n\t\t<h2>Published Articles</h2>\n\t\t<p>No articles have been published</p>\n\t</div>\n</div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":294,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select a.articleID, coalesce( a.[PublishedTitle], a.[Subject]) as 'subject',  a.categoryID, c.Category, cb.initials as 'Owner', wb.initials as 'WrittenBy', a.scheduledfor, d1.shortMonthName+'-'+d1.shortYear as 'Scheduled',a.Released, d2.shortMonthName+'-'+d2.shortYear as 'PubMonth', count(aad.articleID) as AssetCount, pages,notes, len(notes) as noteslen\nfrom Ufiler_2AM_Article a\n\tleft join Ufiler_2AM_ArticleStatus s on a.StatusID = s.statusID\n\tleft join Ufiler_2AM_ArticleCategory c on a.CategoryID = c.CategoryID\n\tleft join Ufiler_2AM_Person cb on a.ownerID = cb.PersonID\n\tleft join Ufiler_2AM_Person wb on a.writtenbyID = wb.PersonID\n\tleft join Ufiler_DateLookup d1 on a.scheduledfor = d1.datekey\n\tleft join Ufiler_DateLookup d2 on a.published = d2.datekey\n\tleft join Ufiler_DateLookup d3 on convert(varchar(8),a.Released,112) = d3.datekey\n\tLeft join Ufiler_2AM_ArticleAssetData aad on a.articleID = aad.ArticleID\nwhere a.moduleID= [ModuleID,system] and Deleted <> '1' and Published > 0 and @Category_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter and @Published_Filter\ngroup by a.moduleid, a.articleID, a.[Subject], a.categoryID, c.Category, cb.initials, wb.initials, a.scheduledfor, d1.shortMonthName+'-'+d1.shortYear,a.Released, d2.shortMonthName+'-'+d2.shortYear, published, pages, PublishedTitle,notes\norder by {IIF, \"'[SORTTAG]'='1' or '[SORTTAG]'='StatusOrder ASC' or '[SORTTAG]'='StatusOrder DESC'\", \"a.published ASC\", \"[SORTTAG]\"}","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":295,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n<h2>Published Articles</h2>\n<table cellspacing=\"3\" cellpadding=\"3\" style=\"width:100%;border:0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n{IIF, \"'[CanAdminister,Action]'='True'\",\"<td class=\\\"iconcol\\\">Unpublish Article</td>\",\"\"}\n\t<td><a {SORT,Subject,\"Subject\",\"Subject&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Subject&nbsp;<img src='/images/dn.gif' style='border:0' />\",,55,Action=ShowPub}>{sortheader,55}</a></th>\n\t<td>Assets</td>\n\t<td>{SUBQUERY, Name=\"getCategories\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory order by SeqNo\" , Header=\"<select id='fltCategory' name='fltCategory' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowPub');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[CategoryID]'>\\[Category]</option>\", SelectedFormat=\"<option value='\\[CategoryID]' selected='selected'>\\[Category]</option>\", SelectedField=\"CategoryID\", SelectedItems=\"[fltCategory,form]\", UseCache=False}<br /><a {SORT,Category,\"Category\",\"Category <img src='/images/up.gif' style='border:0' />\", \"Category <img src='/images/dn.gif' style='border:0' />\",,57,Action=ShowPub}>{sortheader,57}</a></td>\n\t<td>{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='fltOwnerID' name='fltOwner' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowPub');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltOwner,form]\", UseCache=False}<br /><a {SORT,Owner,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,51,Action=ShowPub}>{sortheader,51}</a></td>\n\t<td>{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='fltWrittenBy' name='fltWrittenBy' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowPub');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltWrittenBy,form]\", UseCache=False}<br /><a {SORT,WrittenBy,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,52,Action=ShowPub}>{sortheader,52}</a></td>\n\t<td>{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='fltScheduledFor' name='fltScheduledFor' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowPub');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltScheduledFor,form]\", UseCache=False}<br /><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,53,Action=ShowPub}>{sortheader,53}</a></td>\n\t<td><a {SORT,Released,\"Released\",\"Released&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Released&nbsp;<img src='/images/dn.gif' style='border:0' />\",,56,Action=ShowPub}>{sortheader,56}</a></td>\n\t<td>{SUBQUERY, Name=\"getPublished\", Query=\"select distinct d.datekey, d.shortMonthName + '-' + d.ShortYear as PubMonth from Ufiler_2AM_Article a inner join  Ufiler_DateLookup d on a.Published = d.DateKey order by datekey\" , Header=\"<select id='fltPublished' name='fltPublished' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowPub');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[PubMonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[PubMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltPublished,form]\", UseCache=False}<br /><a {SORT,Published,\"Published\",\"Published&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Published&nbsp;<img src='/images/dn.gif' style='border:0' />\",,54,Action=ShowPub}>{sortheader,54}</a></td>\n\t<td>Pages</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":296,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n{IIF, \"'[CanAdminister,Action]'='True'\",\"<td class=\\\"iconcol\\\"><a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[ModuleId,system\\],0,'Action=UnpublishArticle&ID=\\[ArticleID\\]');\\\"><img src=\\\"/images/lt.gif\\\" alt=\\\"UnpublishArticle\\\" border=\\\"0\\\" /></a></td>\",\"\"}\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n\t<td style=\"text-align:left\">[Released]</td>\n\t<td style=\"text-align:left\">[PubMonth]</td>\n\t<td style=\"text-align:left\">[Pages]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":297,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table></div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":298,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowRel' or [@Action,variable] = 'UnpublishArticle'","RightCondition":"'ShowRel'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":299,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@Header","Value":"<h2 style=\"float:left;margin:-5px 30px 0 0\">Released Articles</h2>\n[@Pager,Action]\n[@RecsPerPage,Action]\n<hr style=\"clear:both\" />","SkipProcessing":"true","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":300,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n<h2>Released Articles</h2>\n<p>No articles have been released.</p></div></div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":301,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"[@SQLHeader,action]\n\nSelect a.articleID, a.[Subject], c.Category,  cb.initials as 'Owner'\n, wb.initials as 'WrittenBy', a.scheduledfor, d1.shortMonthName+'-'+d1.shortYear as 'Scheduled'\n, a.Released, count(aad.articleID) as AssetCount, notes, len(notes) as 'noteslen', ROW_NUMBER() \nOVER ( order by {IIF, \"'[SORTTAG]'='StatusOrder ASC' or '[SORTTAG]'='StatusOrder DESC' or '[SORTTAG]'='Published ASC' or '[SORTTAG]'='Published DESC' or '[SORTTAG]'='1' \", \"a.ArticleID ASC\", \"[SORTTAG]\"}) as RowNumber\nfrom Ufiler_2AM_Article a\n\tleft join Ufiler_2AM_ArticleStatus s on a.StatusID = s.statusID\n\tleft join Ufiler_2AM_ArticleCategory c on a.CategoryID = c.CategoryID\n\tleft join Ufiler_2AM_Person cb on a.ownerID = cb.PersonID\n\tleft join Ufiler_2AM_Person wb on a.writtenbyID = wb.PersonID\n\tleft join Ufiler_DateLookup d1 on a.scheduledfor = d1.datekey\n\tleft join Ufiler_DateLookup d2 on a.published = d2.datekey\n\tLeft join Ufiler_2AM_ArticleAssetData aad on a.articleID = aad.ArticleID\nwhere a.PublicationID= '1' and Deleted <> '1' and a.Released is not null and (published ='0' or published IS NULL) and @Category_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter\ngroup by a.PublicationID, a.articleID, a.[Subject], c.Category,  cb.initials, wb.initials, a.scheduledfor, d1.shortMonthName+'-'+d1.shortYear, a.Released,notes\n\n[@SQLPagerSelects,action]\nfrom Ufiler_2AM_Article a where a.PublicationID= '1' and Deleted <> '1' and a.Released is not null and (published ='0' or published IS NULL) and @Category_Filter and @Owner_Filter and @WrittenBy_Filter and @ScheduledFor_Filter","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":302,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":303,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n[@Header,Action]\n<table cellpadding=\"3\" style=\"width:100%;border:0\">\n<tr class=\"subhead\" valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td style=\"text-align:center\">Recall Article</td><td style=\"text-align:center\">Edit<br />Published<br />Details</td>\n\t<td style=\"text-align:center\"><a {SORT,Subject,\"Subject\",\"Subject&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Subject&nbsp;<img src='/images/dn.gif' style='border:0' />\",,25,Action=ShowRel}>{sortheader,25}</a></td>\n\t<td>Assets</td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getACategories\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory order by SeqNo\" , Header=\"<select id='fltCategory' name='fltCategory' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[CategoryID]'>\\[Category]</option>\", SelectedFormat=\"<option value='\\[CategoryID]' selected='selected'>\\[Category]</option>\", SelectedField=\"CategoryID\", SelectedItems=\"[fltCategory,form]\", UseCache=False}<br /><a {SORT,Category,\"Category\",\"Category <img src='/images/up.gif' style='border:0' />\", \"Category <img src='/images/dn.gif' style='border:0' />\",,27,Action=ShowRel}>{sortheader,27}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='fltOwnerID' name='fltOwner' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltOwner,form]\", UseCache=False}<br /><a {SORT,cb.initials,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,24,Action=ShowRel}>{sortheader,24}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='fltWrittenBy' name='fltWrittenBy' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltWrittenBy,form]\", UseCache=False}<br /><a {SORT,wb.initials,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,23,Action=ShowRel}>{sortheader,23}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='fltScheduledFor' name='fltScheduledFor' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option><option value='0'>Unscheduled</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltScheduledFor,form]\", UseCache=False}<br /><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,22,Action=ShowRel}>{sortheader,22}</a></td>\n\t<td style=\"text-align:left\"><a {SORT,Released,\"Released\",\"Released&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Released&nbsp;<img src='/images/dn.gif' style='border:0' />\",,26,Action=ShowRel}>{sortheader,26}</a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":304,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=RecallArticle&ID=[ArticleID]');\"><img src=\"/images/lt.gif\" alt=\"RecallArticle\" border=\"0\" /></a></td><td style=\"text-align:center\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditReleasedArticle&ID=[ArticleID]');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n\t<td style=\"text-align:left\">[Released]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":305,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"[@Footer,action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":306,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":307,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n[@Header,Action]\n<table cellpadding=\"3\" style=\"width:100%;border:0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td style=\"text-align:left\"><a {SORT,Subject,\"Subject\",\"Subject&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Subject&nbsp;<img src='/images/dn.gif' style='border:0' />\",,25,Action=ShowRel}>{sortheader,25}</a></td>\n\t<td>Assets</td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCategories\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory order by SeqNo\" , Header=\"<select id='fltCategory' name='fltCategory' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", Format=\"<option value='\\[CategoryID]'>\\[Category]</option>\", SelectedFormat=\"<option value='\\[CategoryID]' selected='selected'>\\[Category]</option>\", SelectedField=\"CategoryID\", SelectedItems=\"[fltCategory,form]\", UseCache=False}<br /><a {SORT,Category,\"Category\",\"Category <img src='/images/up.gif' style='border:0' />\", \"Category <img src='/images/dn.gif' style='border:0' />\",,27,Action=ShowRel}>{sortheader,27}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getCommissioners\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person where Commissioner = '1' order by surname, forename\" , Header=\"<select id='fltOwnerID' name='fltOwner' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltOwner,form]\", UseCache=False}<br /><a {SORT,cb.initials,\"Owner\",\"Owner&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Owner&nbsp;<img src='/images/dn.gif' style='border:0' />\",,24,Action=ShowRel}>{sortheader,24}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getWriters\", Query=\"select PersonID, Forename, Surname from Ufiler_2AM_Person order by surname, forename\" , Header=\"<select id='fltWrittenBy' name='fltWrittenBy' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option>\", Footer=\"</select>\", NoResultFormat=\"\", NoQueryFormat=\"\", Format=\"<option value='\\[PersonID]'>\\[Surname], \\[Forename]</option>\", SelectedFormat=\"<option value='\\[PersonID]' selected='selected'>\\[Surname], \\[Forename]</option>\", SelectedField=\"PersonID\", SelectedItems=\"[fltWrittenBy,form]\", UseCache=False}<br /><a {SORT,wb.initials,\"Written&nbsp;By\",\"Written&nbsp;By&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Written&nbsp;By&nbsp;<img src='/images/dn.gif' style='border:0' />\",,23,Action=ShowRel}>{sortheader,23}</a></td>\n\t<td style=\"text-align:left\">{SUBQUERY, Name=\"getScheduledFor\", Query=\"select datekey, shortMonthName + '-' + ShortYear as SchedMonth from Ufiler_DateLookup where monthday = '1' and datekey between convert(varchar(8),dateadd(m,-6,getdate()),112) and convert(varchar(8),dateadd(m,13,getdate()),112) order by datekey\" , Header=\"<select id='fltScheduledFor' name='fltScheduledFor' size='1' onchange=\\\"ows.fetch([moduleid,system],0,'Action=ShowRel');\\\"><option value=''>Show All</option><option value='0'>Unscheduled</option>\", Footer=\"</select>\", Format=\"<option value='\\[datekey]'>\\[schedmonth]</option>\", SelectedFormat=\"<option value='\\[DateKey]' selected='selected'>\\[SchedMonth]</option>\", SelectedField=\"Datekey\", SelectedItems=\"[fltScheduledFor,form]\", UseCache=False}<br /><a {SORT,ScheduledFor,\"Scheduled&nbsp;For\",\"Scheduled&nbsp;For&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Scheduled&nbsp;For&nbsp;<img src='/images/dn.gif' style='border:0' />\",,22,Action=ShowRel}>{sortheader,22}</a></td>\n\t<td style=\"text-align:left\"><a {SORT,Released,\"Released\",\"Released&nbsp;<img src='/images/up.gif' style='border:0' />\", \"Released&nbsp;<img src='/images/dn.gif' style='border:0' />\",,26,Action=ShowRel}>{sortheader,26}</a></td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":308,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowArticle&ID=[ArticleID]');\">(id:[ArticleID]) [Subject]</a>&nbsp;{IIF, \"[noteslen]>0\", \"<a href=\\\"#\\\" class=\\\"tooltip\\\" Title=\\\"\\[Notes\\]\\\"><img src=\\\"/images/help.gif\\\" /></a>\", \"\"}</td>\n\t<td class=\"iconcol\"><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\"><img src='/images/folder.gif' style='border:0' />{IIF, \"[assetcount]>0\", \"([AssetCount])\", \"\"}</a></td>\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td style=\"text-align:left\">[Owner]</td>\n\t<td style=\"text-align:left\">[WrittenBy]</td>\n\t<td style=\"text-align:left\">[Scheduled]</td>\n\t<td style=\"text-align:left\">[Released]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":309,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"[@Footer,action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]}]},{"Index":310,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'ShowSchedule'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":311,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n\t\t<h2>Schedule</h2>\n\t\t<p>No Articles Scheduled for publication</p>\n\t</div>\n</div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":312,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@CategoryHeaderRow","Value":"<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":313,"Level":0,"Parameters":{"Name":"CategoryList","Query":"select Category from Ufiler_2AM_ArticleCategory where PublicationID= '1' order by categoryID","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[{"Index":314,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@CategoryHeaderRow","Value":"<td>[Category,CategoryList]</td>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":315,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"@CategoryHeaderRow","Value":"</tr>","SkipProcessing":"false","AssignmentType":"1"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":316,"Level":0,"Parameters":{"Name":"CategoryTable","Query":"select count(categoryID) as 'CategoryCount' from Ufiler_2AM_ArticleCategory where PublicationID= '1'","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":317,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"select s.Datekey, s.shortMonthName+'-'+s.fullyear as 'IssueMonth', s.CategoryID, a.[Subject],a.statusID, c.Initials from Ufiler_2AM_DatekeyCategory s\n\tleft join Ufiler_2AM_Article a \n\t\tleft join Ufiler_2AM_Person c\n\t\ton a.WrittenByID = c.PersonID\n\ton s.Datekey = a.ScheduledFor and s.CategoryID = a.CategoryID\nwhere c.PublicationID= '1'\norder by s.Datekey, s.CategoryID","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":318,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"[@Buttons,Action]\n<table cellspacing=\"3\" cellpadding=\"3\" Border=\"0\" width=\"100%\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":319,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"[IssueMonth]","GroupIndex":"1","Value":"<tr><td colspan=\"[CategoryCount,CategoryTable]\">&nbsp;</td></tr>\n<tr><td colspan=\"[CategoryCount,CategoryTable]\">&nbsp;</td></tr>\n<tr><td colspan=\"[CategoryCount,CategoryTable]\" align=\"center\"><h2>[IssueMonth]</h2></td></tr>\n[@CategoryHeaderRow,action]\n<tr valign=\"top\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":320,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"[CategoryID]","GroupIndex":"2","Value":"<td>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":321,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<p{IIF, \"'[statusid]'='4'\", \" class='fin'\", \" class='unfin'\"}>[Subject]<br />[Initials]</p>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":322,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"[CategoryID]","GroupIndex":"2","Value":"</td>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":323,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"[IssueMonth]","GroupIndex":"1","Value":"</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":324,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table></div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":325,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowAsset' or '[frmGo,form]' = 'Upload Asset' or '[frmGo,form]' = 'Delete Asset' or '[frmGo,form]' = 'Download Asset'","RightCondition":"'ShowAssets'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":326,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n\t\t<h2>Article Assets</h2>\n\t\t<p>No assets found</p>\n\t</div>\n</div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":327,"Level":0,"Parameters":{"LeftCondition":"[@ID,action]","RightCondition":"NULL","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":328,"Level":0,"Parameters":{"Name":"AssetCount","Query":"Select Count(AssetID) as 'NoOfAssets' FROM Ufiler_2AM_ArticleAssetData where moduleID= [ModuleID,system]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":329,"Level":0,"Parameters":{"LeftCondition":"[NoOfAssets,AssetCount]","RightCondition":"0","Operator":">","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":330,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select ad.AssetID,ad.AssetName,ad.ArticleID,ad.MimeType, ad.assetcredit, ad.assetdescription, (select case mimetype \nwhen 'application/excel' then 'excel'\nwhen 'application/vnd.ms-excel' then 'excel'\nwhen 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' then 'excel'\nwhen 'application/x-excel' then 'excel'\nwhen 'application/x-msexcel' then 'excel'\nwhen 'application/powerpoint' then 'powerpoint'\nwhen 'application/mspowerpoint' then 'powerpoint'\nwhen 'application/vnd.ms-powerpoint' then 'powerpoint'\nwhen 'application/msword' then 'word'\nwhen 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' then 'word'\nwhen 'application/pdf' then 'acrobat'\nwhen 'text/plain' then 'notepad' end) as 'OpenWith'\n,DATALENGTH(ad.Data) Size, a.Subject \nFROM Ufiler_2AM_ArticleAssetData ad\nleft join Ufiler_2AM_Article a\n\ton ad.ArticleID = a.articleID\nwhere ad.moduleID = [ModuleID,system]\norder by ad.AssetID","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]},{"Index":331,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":332,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"","Value":"[@Buttons,Action]\n<h2>All Assets</h2>\n<table border=\"0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td style=\"width:25px\">&nbsp;</td>\n\t<td>&nbsp;</td>\n\t<td>Name</td>\n\t<td>Subject</td>\n\t<td style=\"width:80px;\">Size</td>\n</tr>\n","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":333,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"width:25px;\"><input type=\"checkbox\" name=\"chkFile\" value=\"[AssetID\\]\" /></td>\n\t<td style=\"width:80px;\">\n{IIF, \"[FORMAT,/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,System]/[ArticleID]/Thumbnails/[AssetName].thumb.jpg,{EXISTS}]\", \"<a href=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/Thumbnails/\\[AssetName\\].thumb.jpg\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='word'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/word01-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='excel'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/excel04-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='powerpoint'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/powerpoint08-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='notepad'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/notepad-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='acrobat'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/acrobat-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n</td>\n\t<td>[AssetName]</td>\n\t<td><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAsset&ID=[ArticleID]');\">[Subject]</a></td>\n\t<td style=\"width:80px;\">[Size]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":334,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"","Value":"</td></tr>\n</table>\n<input type=\"submit\" name=\"frmGo\" value=\"Download Asset\" /><input type=\"submit\" name=\"frmGo\" value=\"Delete Asset\" /><br />\n</div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":335,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":336,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"","Value":"[@Buttons,Action]\n<h2>All Assets</h2>\n<table border=\"0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n\t<td>&nbsp;</td>\n\t<td>Name</td>\n\t<td>Subject</td>\n\t<td style=\"width:80px;\">Size</td>\n</tr>\n","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":337,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"width:80px;\">\n{IIF, \"[FORMAT,/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,System]/[ArticleID]/Thumbnails/[AssetName].thumb.jpg,{EXISTS}]\", \"<a href=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/Thumbnails/\\[AssetName\\].thumb.jpg\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='word'\", \"<img src=\\\"/portals/\\[PortalID,system\\]/images/word01-80.png\\\" alt=\\\"\\\" />\", \"\"}\n{IIF, \"'[openwith]'='excel'\", \"<img src=\\\"/portals/\\[PortalID,system\\]/images/excel04-80.png\\\" alt=\\\"\\\" />\", \"\"}\n{IIF, \"'[openwith]'='powerpoint'\", \"<img src=\\\"/portals/\\[PortalID,system\\]/images/powerpoint08-80.png\\\" alt=\\\"\\\" />\", \"\"}\n{IIF, \"'[openwith]'='notepad'\", \"<img src=\\\"/portals/\\[PortalID,system\\]/images/notepad-80.png\\\" alt=\\\"\\\" /><\", \"\"}\n{IIF, \"'[openwith]'='acrobat'\", \"<img src=\\\"/portals/\\[PortalID,system\\]/images/acrobat-80.png\\\" alt=\\\"\\\" />\", \"\"}\n</td>\n\t<td>[AssetName]</td>\n\t<td><a style=\"text-decoration:none\" href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=ShowAssets&ID=[ArticleID]');\">[Subject]</a></td>\n\t<td style=\"width:80px;\">[Size]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":338,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"","Value":"</td></tr>\n</table>\n</div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":339,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":340,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n<h2>Assets</h2>\n<p>No assets found, please go back to the <a href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=ShowActive');\">Active Article listing</a> and select an article to upload assets for.</p>\n</div></div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]}]},{"Index":341,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":342,"Level":0,"Parameters":{"Name":"AssetCount","Query":"Select Count(AssetID) as 'NoOfAssets' FROM Ufiler_2AM_ArticleAssetData where ArticleID = [@ID,action]","IsProcess":"false","Connection":"","CacheName":"","CacheTime":"","CacheShared":"false"},"ActionType":"Action-Execute","ChildActions":[]},{"Index":343,"Level":0,"Parameters":{"LeftCondition":"[NoOfAssets,AssetCount]","RightCondition":"0","Operator":">","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":344,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select AssetID,AssetName,ArticleID,MimeType, assetcredit, assetdescription\n,(select case mimetype \nwhen 'application/excel' then 'excel'\nwhen 'application/vnd.ms-excel' then 'excel'\nwhen 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' then 'excel'\nwhen 'application/x-excel' then 'excel'\nwhen 'application/x-msexcel' then 'excel'\nwhen 'application/powerpoint' then 'powerpoint'\nwhen 'application/mspowerpoint' then 'powerpoint'\nwhen 'application/vnd.ms-powerpoint' then 'powerpoint'\nwhen 'application/msword' then 'word'\nwhen 'application/vnd.openxmlformats-officedocument.wordprocessingml.document' then 'word'\nwhen 'application/pdf' then 'acrobat'\nwhen 'text/plain' then 'notepad' end) \nas 'OpenWith'\n, DATALENGTH(Data) Size FROM Ufiler_2AM_ArticleAssetData \nwhere ArticleID = [@ID,action] order by AssetName","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]},{"Index":345,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"","Value":"[@Buttons,Action]\n<h2>Assets - &quot;{SUBQUERY, Name=\"getSubject\", Query=\"select subject from Ufiler_2AM_Article where articleid = \\[@ID,action\\]\", Format=\"\\[Subject\\]\"}&quot;</h2>\n{IIF, \"'[FORMAT,\"Low Flying Administrators\",{ISINROLE}]'='True'\", \"<b>Upload: </b>&nbsp;<input type=\\\"file\\\" name=\\\"frmFile\\\" size=\\\"75\\\" />\n<input type=\\\"hidden\\\" name=\\\"ID\\\" value=\\\"\\[@ID,action\\]\\\" />\n<input name=\\\"frmGo\\\" value=\\\"Upload Asset\\\" type=\\\"submit\\\" />\n<p>To download files, tick the boxes of the files you want to download.  If you just tick one box the individual file will be downloaded, \nif you tick more than one, they will be zip'd up and the name of the download file will be of the form UserName.ArticleName.Date.zip</p>\",\"\"}\n<table border=\"0\">\n<tr valign=\"bottom\" style=\"font-weight:bold;background-color:#e7e7e7\">\n{IIF, \"'[CanAdminister,Action]'='True'\", \"<td style=\\\"width:25px\\\">&nbsp;</td>\", \"\"}\n\t<td style=\"width:80px;text-align:right;\">&nbsp;</td>\n\t<td style=\"width:200px;\">Asset Name</td>\n\t<td style=\"width:200px;\">Asset Description</td>\n\t<td style=\"width:200px;\">Asset Credit</td>\n\t<td style=\"width:80px;text-align:right;\">Size</td>\n</tr>\n","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":346,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n{IIF, \"'[CanAdminister,Action]'='True'\", \"<td style=\\\"width:25px;\\\"><input type=\\\"checkbox\\\" name=\\\"chkFile\\\" value=\\\"\\[AssetID\\]\\\"/></td>\", \"\"}\n\t<td style=\"width:80px;\">\n{IIF, \"[FORMAT,/portals/[PortalID,system]/Ufiler_2AM_ArticleAsset/[ModuleID,System]/[ArticleID]/Thumbnails/[AssetName].thumb.jpg,{EXISTS}]\", \"<a href=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/Ufiler_2AM_ArticleAsset/\\[ModuleID,System\\]/\\[ArticleID\\]/Thumbnails/\\[AssetName\\].thumb.jpg\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='word'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/word01-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='excel'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/excel04-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='powerpoint'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/powerpoint08-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='notepad'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/notepad-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n{IIF, \"'[openwith]'='acrobat'\", \"<a href=\\\"/portals/\\[PortalID,system\\]/\\Ufiler_2AM_ArticleAsset/\\[ArticleID\\]/\\[AssetName\\]\\\" target=\\\"_blank\\\"><img src=\\\"/portals/\\[PortalID,system\\]/images/acrobat-80.png\\\" alt=\\\"\\\" /></a>\", \"\"}\n</td>\n</td>\n\t<td>[AssetName]</td>\n\t<td>[AssetDescription]</td>\n\t<td>[AssetCredit]</td>\n\t<td style=\"width:80px;text-align:right;\">[Size]</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":347,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"","Value":"</td></tr>\n</table>\n{IIF, \"'[CanAdminister,Action]'='True'\", \"<input type=\\\"submit\\\" name=\\\"frmGo\\\" value=\\\"Download Asset\\\" /> <input type=\\\"submit\\\" name=\\\"frmGo\\\" value=\\\"Delete Asset\\\" /><br />\",\"\"}\n<div id=\"dvValidate\"></div>\n</div></div>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":348,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":349,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,Action]\n<h2>Assets - &quot;{SUBQUERY, Name=\"getSubject\", Query=\"select subject from Ufiler_2AM_Article where articleid = \\[@ID,action\\]\", Format=\"\\[Subject\\]\"}&quot;</h2>\n<p>No Assets found {IIF, \"'[CanAdminister,Action]'='True'\", \"please browse to a file on your computer and click the upload button</p>\n<input type=\\\"file\\\" name=\\\"frmFile\\\" size=\\\"75\\\" /><input type=\\\"hidden\\\" name=\\\"ID\\\" value=\\\"\\[@ID,action\\]\\\">\n<input name=\\\"frmGo\\\" value=\\\"Upload Asset\\\" type=\\\"submit\\\" />\",\"</p>\"}\n</div></div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]}]}]},{"Index":350,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'Admin' or [@Action,variable] = 'ShowStats'","RightCondition":"'Admin'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":351,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"[@Buttons,action]\n\t\t{IIF, \"'[CanAdminister,Action]'='True'\", \"<h2>Administration</h2>\", \"<h2>Statistics</h2>\"}\n\t\t[DisplayPerson,action]\n\t\t[DisplayCategory,action]\n\t\t[DisplayStatus,action]\n\t\t[DisplayPublication,action]\n\t</div>\n</div>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":352,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'AddCategory'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":353,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>Category</h3>\n<table width=\"98%\" cellspacing=\"3\" cellpadding=\"3\" align=\"left\">\n\t<tr> \n\t\t<td class=\"subhead\">Category</td>\n\t\t<td class=\"normal\"><input type=\"text\" name=\"frmCategory\" /></td>\n\t</tr>\n\t<tr valign=\"top\"> \n\t\t<td class=\"subhead\">Insert</td>\n\t\t<td class=\"normal\"><input type=\"radio\" name=\"frmInsertWhere\" value=\"before\" id=\"cpBefore\" /> <label for=\"cpBefore\">Before</label> \n\t\t\t<input type=\"radio\" name=\"frmInsertWhere\" value=\"after\" id=\"cpAfter\" /> <label for=\"cpAfter\">After</label><br />\n\t\t{SUBQUERY, Name=\"getCategories\", Query=\"select CategoryID, Category from Ufiler_2AM_ArticleCategory where moduleID = '[moduleID,system]' order by SeqNo\" , Header=\"<select id='frmArticleCategory' name='frmArticleCategory' size='1'>\", Footer=\"</select>\", NoResultFormat=\"<select id='frmArticleCategory' name='frmArticleCategory' size='1'><option value='0'>New Category</option></select>\", Format=\"<option value='\\[CategoryID]'>\\[Category]</option>\", SelectedFormat=\"<option value='\\[CategoryID]' selected='selected'>\\[Category]</option>\", SelectedField=\"CategoryID\", UseCache=False}</td>\n\t<tr>\n\t\t<td colspan=\"2\" align=\"center\">\n\t\t\t<hr />\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=InsertCategory','dvCategory');\">Add This Category</button>\n\t\t\t&nbsp;&nbsp;\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=ShowCategory','dvCategory');\">Cancel</button> \n\t\t</td>\n\t</tr>\n</table>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":354,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'EditCategory'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":355,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select CategoryId, Category, SeqNo from Ufiler_2AM_ArticleCategory\nwhere CategoryId= [@ID,Action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":356,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<h3>Category</h3>\n<table width=\"98%\" cellspacing=\"3\" cellpadding=\"3\">\n\t<tr> \n\t\t<td align=\"right\">Category</td>\n\t\t<td align=\"left\"><input type=\"text\" name=\"frmCategory\" value=\"[Category]\" /></td>\n\t</tr>\n\t<tr>\n\t\t<td colspan=\"2\" align=\"center\">\n\t\t\t<hr />\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=UpdateCategory&ID=[CategoryID]','dvCategory');\">Save</button>\n\t\t\t&nbsp;|&nbsp;\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=ShowCategory','dvCategory');\">Cancel</button> \n\t\t</td>\n\t</tr>\n</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":357,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowPerson' or [@Action,variable] = 'InsertPerson' or [@Action,variable] = 'UpdatePerson' or [@Action,variable] = 'DeletePerson'","RightCondition":"","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":358,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>People</h3>\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddPerson','dvPerson');\">Add A New Person</button>\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":359,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"select p.PersonID, p.surname, p.forename, (select count(ownerID) from Ufiler_2AM_Article where OwnerID = PersonID) as OwnerCount, (select count(WrittenByID) from Ufiler_2AM_Article where WrittenByID = PersonID)as WriterCount\nfrom Ufiler_2AM_Person p  \n\tleft join Ufiler_2AM_Article a on p.PersonID = a.OwnerID \n\tleft join Ufiler_2AM_Article b on p.PersonID = b.WrittenByID \nWhere p.PublicationID= '1'\nGroup by p.PersonID, p.surname, p.forename \norder by p.surname","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":360,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<h3>People</h3>\n{IIF, \"'[CanAdminister,Action]'='True'\", \"<button type=\\\"button\\\" onclick=\\\"javascript:ows.fetch(\\[moduleID,system\\],-1,'Action=AddPerson','dvPerson');\\\">Add A New Person</button>\",\"No Persons found.\"}\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"width:98%;border:0\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":361,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n{IIF, \"'[CanAdminister,Action]'='True'\", \"<td><a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[ModuleId,system\\],0,'Action=EditPerson&ID=\\[PersonID\\]','dvPerson');\\\"><img src=\\\"/images/edit.gif\\\" alt=\\\"Edit\\\" border=\\\"0\\\" /></a></td>\",\"\"}\n\t<td style=\"text-align:left\">[surname], [forename]</td>\n{IIF, \"'[CanAdminister,Action]'='True'\", \"<td align=\\\"right\\\">\\{IIF, \\\"\\[OwnerCount\\]>0 OR \\[WriterCount\\]>0\\\",\\\"(\\[WriterCount\\])\\\",\\\"<a href=\\\\\"javascript:ows.Fetch(\\[ModuleId,system\\],0,'Action=DeletePerson&ID=\\[PersonID\\]','dvPerson');\\\\\" onclick=\\\\\"return confirm('Are you sure that you want to delete \\[surname\\], \\[forename\\]? \\nThis action can not be undone.');\\\\\"><img src=\\\\\"/images/delete.gif\\\\\" alt=\\\\\"Delete\\\\\" border=\\\\\"0\\\\\" /></a>\\\"\\}</td>\",\"<td align=\\\"right\\\">(\\[WriterCount\\])</td>\"}\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":362,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":363,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowCategory' or [@Action,variable] = 'InsertCategory' or [@Action,variable] = 'UpdateCategory'  or [@Action,variable] = 'MoveCategory' or [@Action,variable] = 'DeleteCategory'","RightCondition":"'ShowCategory'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":364,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>Category</h3>\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddCategory','dvCategory');\">Add Category Value</button>\n","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":365,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"select c.CategoryID, c.Category, c.SeqNo, (select max(SeqNo) from  Ufiler_2AM_ArticleCategory where moduleID= [ModuleID,system]) as MaxOrderCat, (select min(SeqNo) from  Ufiler_2AM_ArticleCategory where moduleID = [ModuleID,system])  as MinOrderCat, count(a.CategoryID) as CategoryCount \nfrom Ufiler_2AM_ArticleCategory c  left join Ufiler_2AM_Article a on c.CategoryID= a.CategoryID\nwhere c.moduleID = [ModuleID,system] \nGroup by c.CategoryID, c.Category, c.SeqNo \norder by c.SeqNo, c.Category","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":366,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":367,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<h3>Category</h3>\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddCategory','dvCategory');\">Add A New Category</button>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"border:0;width:98%\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":368,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditCategory&ID=[CategoryID]','dvCategory');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"[SeqNo]<[MaxOrderCat]\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveCategory&ID=\\[CategoryId]&Direction=down','dvCategory')\\\"><img src='/images/dn.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td class=\"iconcol\">{IIF, \"[SeqNo]>[MinOrderCat]\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveCategory&ID=\\[CategoryId]&Direction=up','dvCategory')\\\"><img src='/images/up.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Category] {IIF, \"[CategoryCount]>0\",\"([CategoryCount])\",\"<a href=\\\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeleteCategory&ID=[CategoryID]','dvCategory');\\\" onclick=\\\"return confirm('Are you sure that you want to delete &quot;[Category]&quot;? \\nThis action can not be undone.');\\\"><img src=\\\"/images/delete.gif\\\" alt=\\\"Delete\\\" border=\\\"0\\\" /></a>\"}</td>\n</tr>\n","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":369,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":370,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":371,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<h3>Category</h3>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"width:98%;border:0\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":372,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\">[Category]</td>\n\t<td align=\"right\">([CategoryCount])</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":373,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]}]},{"Index":374,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowStatus' or [@Action,variable] = 'InsertStatus' or [@Action,variable] = 'MoveStatus'  or [@Action,variable] = 'UpdateStatus' or [@Action,variable] = 'DeleteStatus'","RightCondition":"'ShowStatus'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":375,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>Status</h3>\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddStatus','dvStatus');\">Add A New Status</button>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":376,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"select s.statusID, s.status, s.Releasable, s.SeqNo, (select max(SeqNo) from  Ufiler_2AM_ArticleStatus) as MaxOrder, (select min(SeqNo) from  Ufiler_2AM_ArticleStatus)  as MinOrder, count(a.statusID) as StatusCount \nfrom Ufiler_2AM_ArticleStatus s  left join Ufiler_2AM_Article a on s.statusID= a.StatusID\nGroup by s.statusID, s.status, s.Releasable, s.SeqNo \norder by s.SeqNo, s.status","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":377,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":378,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<h3>Status</h3>\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddStatus','dvStatus');\">Add A New Status</button>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"border:0;width:98%\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":379,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditStatus&ID=[StatusID]','dvStatus');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo]'<'[MaxOrder]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveStatus&ID=\\[StatusId]&Direction=down','dvStatus')\\\"><img src='/images/dn.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo]'>'[MinOrder]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MoveStatus&ID=\\[StatusId]&Direction=up','dvStatus')\\\"><img src='/images/up.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Status]{IIF, \"'[Releasable]'='True'\", \"<span style='font-size:smaller'>(R)</span>\", \"\"} &nbsp;\n\t{IIF, \"[StatusCount]>0\",\"([StatusCount])\",\"<a href=\\\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeleteStatus&ID=[StatusID]','dvStatus');\\\" onclick=\\\"return confirm('Are you sure that you want to delete &quot;[Status]&quot;? \\nThis action can not be undone.');\\\"><img src=\\\"/images/delete.gif\\\" alt=\\\"Delete\\\" border=\\\"0\\\" /></a>\"}</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":380,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":381,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":382,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<h3>Status</h3>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"width:100%\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":383,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\">[Status]</td>\n\t<td align=\"right\">([StatusCount])</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":384,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]}]},{"Index":385,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable] = 'ShowPublication' or [@Action,variable] = 'InsertPublication' or [@Action,variable] = 'MovePublication'  or [@Action,variable] = 'UpdatePublication' or [@Action,variable] = 'DeletePublication'","RightCondition":"'ShowStatus'","Operator":"=","IsAdvanced":"True"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":386,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>Publication</h3>\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddPublication','dvPublication');\">Add A New Publication</button>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]},{"Index":387,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"select p.PublicationID, p.Publication, p.SeqNo, (select max(SeqNo) from  Ufiler_2AM_Publication) as MaxOrder, (select min(SeqNo) from  Ufiler_2AM_Publication)  as MinOrder, count(a.PublicationID) as ArticleCount \nfrom Ufiler_2AM_Publication p  left join Ufiler_2AM_Article a on p.PublicationID= a.PublicationID\nGroup by p.PublicationID, p.Publication, p.SeqNo \norder by p.SeqNo, p.Publication","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":388,"Level":0,"Parameters":{"LeftCondition":"'[CanAdminister,Action]'","RightCondition":"'True'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-If","ChildActions":[{"Index":389,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<h3>Publication</h3>\n<button type=\"button\" href= '#' onclick=\"javascript:ows.fetch([moduleID,system],0,'Action=AddPublication','dvPublication');\">Add A New Publication</button>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"border:0;width:98%\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":390,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td class=\"iconcol\"><a href=\"#\" onclick=\"javascript:ows.Fetch([ModuleId,system],0,'Action=EditPublication&ID=[PublicationID]','dvPublication');\"><img src=\"/images/edit.gif\" alt=\"Edit\" border=\"0\" /></a></td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo]'<'[MaxOrder]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MovePublication&ID=\\[PublicationId]&Direction=down','dvPublication')\\\"><img src='/images/dn.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td class=\"iconcol\">{IIF, \"'[SeqNo]'>'[MinOrder]'\", \"<a href=\\\"#\\\" onclick=\\\"javascript:ows.Fetch(\\[moduleID,system],0,'Action=MovePublication&ID=\\[PublicationId]&Direction=up','dvPublication')\\\"><img src='/images/up.gif' style='border:0' /></a>\", \"\"}</td>\n\t<td style=\"text-align:left\">[Publication] &nbsp;\n\t{IIF, \"[ArticleCount]>0\",\"([ArticleCount])\",\"<a href=\\\"javascript:ows.Fetch([ModuleId,system],0,'Action=DeletePublication&ID=[PublicationID]','dvPublication');\\\" onclick=\\\"return confirm('Are you sure that you want to delete &quot;[Publication]&quot;? \\nThis action can not be undone.');\\\"><img src=\\\"/images/delete.gif\\\" alt=\\\"Delete\\\" border=\\\"0\\\" /></a>\"}</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":391,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":392,"Level":0,"Parameters":{},"ActionType":"Condition-Else","ChildActions":[{"Index":393,"Level":0,"Parameters":{"Type":"Group-Header","GroupStatement":"","GroupIndex":"0","Value":"<h3>Publication</h3>\n<table cellspacing=\"1\" cellpadding=\"1\" style=\"width:100%\">","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":394,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<tr valign=\"top\">\n\t<td style=\"text-align:left\">[Publication]</td>\n\t<td align=\"right\">([ArticleCount])</td>\n</tr>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]},{"Index":395,"Level":0,"Parameters":{"Type":"Group-Footer","GroupStatement":"","GroupIndex":"0","Value":"</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]}]},{"Index":396,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'AddPerson'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":397,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>People</h3>\n<table width=\"98%\" cellspacing=\"3\" cellpadding=\"3\">\n\t<tr> \n\t\t<td class=\"subhead\">Forename</td>\n\t\t<td class=\"normal\"><input type=\"text\" name=\"frmForename\" /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Surname</td>\n\t\t<td class=\"normal\"><input type=\"text\" name=\"frmSurname\" /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Commissioner</td>\n\t\t<td class=\"normal\"><input type=\"checkbox\" name=\"frmCommissioner\" value=\"1\" /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Author</td>\n\t\t<td class=\"normal\"><input type=\"checkbox\" name=\"frmAuthor\" value=\"1\" /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Reviewer</td>\n\t\t<td class=\"normal\"><input type=\"checkbox\" name=\"frmReviewer\" value=\"1\" /></td>\n\t</tr>\n\t<tr>\n\t\t<td colspan=\"2\" align=\"center\">\n\t\t\t<hr />\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=InsertPerson','dvPerson');\">Add This Person</button>\n\t\t\t&nbsp;&nbsp;\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],-1,'Action=ShowPerson','dvPerson');\">Cancel</button> \n\t\t</td>\n\t</tr>\n</table>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":398,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'EditPerson'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":399,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select PersonId, Forename, Surname, Commissioner,Author,Reviewer from Ufiler_2AM_Person\nwhere PersonId= [@ID,Action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":400,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<h3>People</h3>\n<table width=\"98%\" cellspacing=\"3\" cellpadding=\"3\">\n\t<tr> \n\t\t<td class=\"subhead\">Forename</td>\n\t\t<td class=\"normal\"><input type=\"text\" name=\"frmForename\" value=\"[Forename]\" /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Surname</td>\n\t\t<td class=\"normal\"><input type=\"text\" name=\"frmSurname\" value=\"[Surname]\" /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Commissioner</td>\n\t\t<td class=\"normal\"><input type=\"checkbox\" name=\"frmCommissioner\" value=\"1\" {IIF, \"'[Commissioner]'='True'\", \"checked='checked'\", \"\"} /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Author</td>\n\t\t<td class=\"normal\"><input type=\"checkbox\" name=\"frmAuthor\" value=\"1\" {IIF, \"'[Author]'='True'\", \"checked='checked'\", \"\"} /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Reviewer</td>\n\t\t<td class=\"normal\"><input type=\"checkbox\" name=\"frmReviewer\" value=\"1\" {IIF, \"'[Reviewer]'='True'\", \"checked='checked'\", \"\"} /></td>\n\t</tr>\t<tr>\n\t\t<td colspan=\"2\" align=\"center\">\n\t\t\t<hr />\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=UpdatePerson&ID=[PersonID]','dvPerson');\">Save</button>\n\t\t\t&nbsp;|&nbsp;\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=ShowPerson','dvPerson');\">Cancel</button> \n\t\t</td>\n\t</tr>\n</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":401,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'AddStatus'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":402,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>Status</h3>\n<table width=\"98%\" cellspacing=\"3\" cellpadding=\"3\">\n\t<tr> \n\t\t<td class=\"subhead\">Status</td>\n\t\t<td class=\"normal\"><input type=\"text\" name=\"frmArticleStatus\" /></td>\n\t</tr>\n\t<tr valign=\"top\"> \n\t\t<td class=\"subhead\">Insert</td>\n\t\t<td class=\"normal\"><input type=\"radio\" name=\"frmInsertWhere\" value=\"before\" id=\"cpBefore\" /> <label for=\"cpBefore\">Before</label> \n\t\t\t<input type=\"radio\" name=\"frmInsertWhere\" value=\"after\" id=\"cpAfter\" /> <label for=\"cpAfter\" >After</label><br />\n\t\t\t{SUBQUERY, Name=\"getStatus\", Query=\"select StatusID, Status from Ufiler_2AM_ArticleStatus where moduleID = '[moduleID,system]' order by SeqNo\" , Header=\"<select id='ID' name='ID' size='1'>\", Footer=\"</select>\", NoResultFormat=\"<select id='ID' name='ID' size='1'><option value='0'>New Status</option></select>\", Format=\"<option value='\\[StatusID]'>\\[Status]</option>\", SelectedFormat=\"<option value='\\[StatusID]' selected='selected'>\\[Status]</option>\", SelectedField=\"StatusID\", UseCache=False}</td>\n\t<tr>\n\t<tr> \n\t\t<td class=\"subhead\">Release Status</td>\n\t\t<td class=\"normal\" colspan=\"2\"><input type=\"checkbox\" name=\"frmReleasable\" value=\"1\" id=\"cbCBR\" /></td>\n\t<tr>\n\t<tr>\n\t\t<td colspan=\"2\" align=\"center\">\n\t\t\t<hr />\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=InsertStatus','dvStatus');\">Add This Status</button>\n\t\t\t&nbsp;&nbsp;\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=ShowStatus','dvStatus');\">Cancel</button> \n\t\t</td>\n\t</tr>\n</table>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":403,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'EditStatus'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":404,"Level":0,"Parameters":{"Type":"Query-Query","GroupStatement":"","GroupIndex":"","Value":"Select StatusId, Status, Releasable, SeqNo from Ufiler_2AM_ArticleStatus\nwhere StatusId= [@ID,Action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[{"Index":405,"Level":0,"Parameters":{"Type":"Detail-Detail","GroupStatement":"","GroupIndex":"","Value":"<h3>Status</h3>\n<table width=\"98%\" cellspacing=\"3\" cellpadding=\"3\">\n\t<tr> \n\t\t<td align=\"right\">Status</td>\n\t\t<td align=\"left\"><input type=\"text\" name=\"frmArticleStatus\" value=\"[Status]\" /></td>\n\t</tr>\n\t<tr> \n\t\t<td class=\"subhead\">Is Release Status</td>\n\t\t<td class=\"normal\"><input type=\"checkbox\" name=\"frmReleasable\" value=\"1\" id=\"cbCBR\" {IIF, \"'[Releasable]'='True'\", \"checked='checked'\", \"\"} /></td>\n\t<tr>\n\t<tr>\n\t\t<td colspan=\"2\" align=\"center\">\n\t\t\t<hr />\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=UpdateStatus&ID=[StatusID]','dvStatus');\">Save</button>\n\t\t\t&nbsp;|&nbsp;\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=ShowStatus','dvStatus');\">Cancel</button> \n\t\t</td>\n\t</tr>\n</table>","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}]},{"Index":406,"Level":0,"Parameters":{"LeftCondition":"[@Action,variable]","RightCondition":"'AddPublication'","Operator":"=","IsAdvanced":"False"},"ActionType":"Condition-ElseIf","ChildActions":[{"Index":407,"Level":0,"Parameters":{"Type":"&lt;Action&gt;","Name":"Result","Value":"<h3>Publication</h3>\n<table width=\"98%\" cellspacing=\"3\" cellpadding=\"3\">\n\t<tr> \n\t\t<td class=\"subhead\">Publication</td>\n\t\t<td class=\"normal\"><input type=\"text\" name=\"frmPublication\" /></td>\n\t</tr>\n\t<tr valign=\"top\"> \n\t\t<td class=\"subhead\">Insert</td>\n\t\t<td class=\"normal\"><input type=\"radio\" name=\"frmInsertWhere\" value=\"before\" id=\"cpBefore\" /> <label for=\"cpBefore\">Before</label> \n\t\t\t<input type=\"radio\" name=\"frmInsertWhere\" value=\"after\" id=\"cpAfter\" /> <label for=\"cpAfter\" >After</label><br />\n\t\t\t{SUBQUERY, Name=\"getPublication\", Query=\"select PublicationID, Publication from Ufiler_2AM_Publication where PortalID = '[PortalID,system]' order by SeqNo\" , Header=\"<select id='ID' name='ID' size='1'>\", Footer=\"</select>\", NoResultFormat=\"<select id='ID' name='ID' size='1'><option value='0'>New Publication</option></select>\", Format=\"<option value='\\[PublicationID]'>\\[Publication]</option>\", SelectedFormat=\"<option value='\\[PublicationID]' selected='selected'>\\[Publication]</option>\", SelectedField=\"PublicationID\", UseCache=False}</td>\n\t<tr>\n\t<tr>\n\t\t<td colspan=\"2\" align=\"center\">\n\t\t\t<hr />\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=InsertPublication','dvPublication');\">Add This Publication</button>\n\t\t\t&nbsp;&nbsp;\n\t\t\t<button type=\"button\" onclick=\"javascript:ows.Fetch([ModuleId,System],0,'Action=ShowPublication','dvPublication');\">Cancel</button> \n\t\t</td>\n\t</tr>\n</table>","SkipProcessing":"false","AssignmentType":"0"},"ActionType":"Action-Assignment","ChildActions":[]}]},{"Index":408,"Level":0,"Parameters":{"Type":"Detail-NoResults","GroupStatement":"","GroupIndex":"","Value":"[Result,Action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]},{"Index":409,"Level":0,"Parameters":{"Type":"Detail-NoQuery","GroupStatement":"","GroupIndex":"","Value":"[Result,action]","Connection":"","Filter":"","CacheTime":"","CacheName":"","CacheShared":"false"},"ActionType":"Template","ChildActions":[]}]}],"recordsPerPage":"0","enableAlphaFilter":"false","enablePageSelection":"false","enableRecordsPerPage":"false","enableCustomPaging":"false","enableExcelExport":false,"enableHide_OnNoQuery":false,"enableHide_OnNoResults":false,"enableAdvancedParsing":true,"enableCompoundIIFConditions":"true","enableQueryDebug":"true","enableQueryDebug_Edit":"false","enableQueryDebug_Admin":"false","enableQueryDebug_Super":"true","enableQueryDebug_Log":false,"enableQueryDebug_ErrorLog":false,"autoRefreshInterval":"","skipRedirectActions":"false","skipSubqueryDebugging":"false","enableAdmin_Edit":true,"enableAdmin_Admin":false,"enableAdmin_Super":false,"BotRecordCount":0,"BotPageVariableName":null,"enableBotShowAllRecords":false,"enableBotDetection":false,"BotNonAjaxText":null,"disableOpenScript":false,"enableSilverlight":false,"enableAJAX":"false","enableAJAXPaging":"true","enableAJAXCustomPaging":"false","enableAJAXCustomStatus":"false","enableAJAXPageHistory":"true","customAJAXPageHistory":"","enableAJAXManual":"false","includeJavascriptUtilities":"false","includeJavascriptValidation":"false","javascriptInclude":[],"javascriptOnComplete":"","enableMultipleColumnSorting":"false","ModuleCommunicationMessageType":"","showAll":"true","useExplicitSystemVariables":"true","enabledForcedQuerySplit":"false","query":"","filter":"","customConnection":"","listItem":"","listAItem":"","defaultItem":"","noqueryItem":"","SearchQuery":"","SearchTitle":"","SearchLink":"","SearchAuthor":"","SearchDate":"","SearchKey":"","SearchContent":"","SearchDescription":"","Header":null,"Footer":null,"Title":null,"Version":"20"}